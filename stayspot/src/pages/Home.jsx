




// // // // // // // // // // // // // // // // // // // import React, { useEffect, useState, useRef, useCallback } from "react";
// // // // // // // // // // // // // // // // // // // import Seo from "../components/Seo.jsx";
// // // // // // // // // // // // // // // // // // // import PostList from "../components/PostList.jsx";
// // // // // // // // // // // // // // // // // // // import { Loader, ErrorState } from "../components/Loader.jsx";
// // // // // // // // // // // // // // // // // // // import LiveNewsSection from "../components/LiveNewsSection.jsx";
// // // // // // // // // // // // // // // // // // // import TrendingPost from "../components/TrendingPost.jsx";
// // // // // // // // // // // // // // // // // // // import debounce from "lodash.debounce";

// // // // // // // // // // // // // // // // // // // const POSTS_PER_PAGE = 10;

// // // // // // // // // // // // // // // // // // // const Home = () => {
// // // // // // // // // // // // // // // // // // //   const [categories, setCategories] = useState([{ slug: "all", label: "All", postCount: 0 }]);
// // // // // // // // // // // // // // // // // // //   const [selectedCategory, setSelectedCategory] = useState("all");
// // // // // // // // // // // // // // // // // // //   const [searchTerm, setSearchTerm] = useState("");
// // // // // // // // // // // // // // // // // // //   const [debouncedTerm, setDebouncedTerm] = useState("");
// // // // // // // // // // // // // // // // // // //   const [posts, setPosts] = useState([]);
// // // // // // // // // // // // // // // // // // //   const [page, setPage] = useState(1);
// // // // // // // // // // // // // // // // // // //   const [hasMore, setHasMore] = useState(true);
// // // // // // // // // // // // // // // // // // //   const [loadingPosts, setLoadingPosts] = useState(false);
// // // // // // // // // // // // // // // // // // //   const [error, setError] = useState(null);
// // // // // // // // // // // // // // // // // // //   const [autocompleteItems, setAutocompleteItems] = useState([]);
// // // // // // // // // // // // // // // // // // //   const [showAutocomplete, setShowAutocomplete] = useState(false);
// // // // // // // // // // // // // // // // // // //   const [darkMode, setDarkMode] = useState(false);
// // // // // // // // // // // // // // // // // // //   const loadMoreRef = useRef(null);
// // // // // // // // // // // // // // // // // // //   const scrollProgressRef = useRef(null);
// // // // // // // // // // // // // // // // // // //   const stickyTabsRef = useRef(null);

// // // // // // // // // // // // // // // // // // //   // Fetch categories with counts
// // // // // // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // // // // // //     fetch("http://localhost:4000/api/categories")
// // // // // // // // // // // // // // // // // // //       .then((res) => res.json())
// // // // // // // // // // // // // // // // // // //       .then((data) => {
// // // // // // // // // // // // // // // // // // //         const cats = data.map((c) => ({
// // // // // // // // // // // // // // // // // // //           slug: c.slug,
// // // // // // // // // // // // // // // // // // //           label: c.name,
// // // // // // // // // // // // // // // // // // //           postCount: c.count || 0,
// // // // // // // // // // // // // // // // // // //         }));
// // // // // // // // // // // // // // // // // // //         setCategories([
// // // // // // // // // // // // // // // // // // //           { slug: "all", label: "All", postCount: cats.reduce((a, b) => a + b.postCount, 0) },
// // // // // // // // // // // // // // // // // // //           ...cats,
// // // // // // // // // // // // // // // // // // //         ]);
// // // // // // // // // // // // // // // // // // //       });
// // // // // // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // // // // // //   // Debounce search
// // // // // // // // // // // // // // // // // // //   const debouncedSearch = useCallback(
// // // // // // // // // // // // // // // // // // //     debounce((val) => {
// // // // // // // // // // // // // // // // // // //       setDebouncedTerm(val);
// // // // // // // // // // // // // // // // // // //       setPage(1);
// // // // // // // // // // // // // // // // // // //       setPosts([]);
// // // // // // // // // // // // // // // // // // //     }, 400),
// // // // // // // // // // // // // // // // // // //     []
// // // // // // // // // // // // // // // // // // //   );

// // // // // // // // // // // // // // // // // // //   // On search input change
// // // // // // // // // // // // // // // // // // //   const onSearchChange = (e) => {
// // // // // // // // // // // // // // // // // // //     setSearchTerm(e.target.value);
// // // // // // // // // // // // // // // // // // //     debouncedSearch(e.target.value);
// // // // // // // // // // // // // // // // // // //   };

// // // // // // // // // // // // // // // // // // //   // Fetch posts API
// // // // // // // // // // // // // // // // // // //   const fetchPosts = useCallback(() => {
// // // // // // // // // // // // // // // // // // //     setLoadingPosts(true);
// // // // // // // // // // // // // // // // // // //     setError(null);

// // // // // // // // // // // // // // // // // // //     let baseUrl =
// // // // // // // // // // // // // // // // // // //       selectedCategory === "all"
// // // // // // // // // // // // // // // // // // //         ? `http://localhost:4000/api/posts`
// // // // // // // // // // // // // // // // // // //         : `http://localhost:4000/api/posts?category=${selectedCategory}`;

// // // // // // // // // // // // // // // // // // //     const url = new URL(baseUrl);
// // // // // // // // // // // // // // // // // // //     if (debouncedTerm.trim()) url.searchParams.set("q", debouncedTerm.trim());
// // // // // // // // // // // // // // // // // // //     url.searchParams.set("page", page);
// // // // // // // // // // // // // // // // // // //     url.searchParams.set("limit", POSTS_PER_PAGE);

// // // // // // // // // // // // // // // // // // //     fetch(url.toString())
// // // // // // // // // // // // // // // // // // //       .then((res) => {
// // // // // // // // // // // // // // // // // // //         if (!res.ok) throw new Error("Failed to load posts");
// // // // // // // // // // // // // // // // // // //         return res.json();
// // // // // // // // // // // // // // // // // // //       })
// // // // // // // // // // // // // // // // // // //       .then((data) => {
// // // // // // // // // // // // // // // // // // //         const newPosts = selectedCategory === "all" ? data.results || [] : data.posts || [];
// // // // // // // // // // // // // // // // // // //         setPosts((prev) => (page === 1 ? newPosts : [...prev, ...newPosts]));
// // // // // // // // // // // // // // // // // // //         setHasMore(newPosts.length === POSTS_PER_PAGE);
// // // // // // // // // // // // // // // // // // //         setLoadingPosts(false);
// // // // // // // // // // // // // // // // // // //       })
// // // // // // // // // // // // // // // // // // //       .catch((e) => {
// // // // // // // // // // // // // // // // // // //         setError(e.message);
// // // // // // // // // // // // // // // // // // //         setLoadingPosts(false);
// // // // // // // // // // // // // // // // // // //       });
// // // // // // // // // // // // // // // // // // //   }, [page, selectedCategory, debouncedTerm]);

// // // // // // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // // // // // //     fetchPosts();
// // // // // // // // // // // // // // // // // // //   }, [fetchPosts]);

// // // // // // // // // // // // // // // // // // //   // Infinite scroll observer
// // // // // // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // // // // // //     if (!hasMore || loadingPosts) return;
// // // // // // // // // // // // // // // // // // //     const observer = new IntersectionObserver(
// // // // // // // // // // // // // // // // // // //       ([entry]) => {
// // // // // // // // // // // // // // // // // // //         if (entry.isIntersecting) setPage((p) => p + 1);
// // // // // // // // // // // // // // // // // // //       },
// // // // // // // // // // // // // // // // // // //       { rootMargin: "200px" }
// // // // // // // // // // // // // // // // // // //     );
// // // // // // // // // // // // // // // // // // //     const current = loadMoreRef.current;
// // // // // // // // // // // // // // // // // // //     if (current) observer.observe(current);
// // // // // // // // // // // // // // // // // // //     return () => current && observer.unobserve(current);
// // // // // // // // // // // // // // // // // // //   }, [hasMore, loadingPosts]);

// // // // // // // // // // // // // // // // // // //   // Autocomplete suggestions
// // // // // // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // // // // // //     if (!searchTerm.trim()) {
// // // // // // // // // // // // // // // // // // //       setAutocompleteItems([]);
// // // // // // // // // // // // // // // // // // //       setShowAutocomplete(false);
// // // // // // // // // // // // // // // // // // //       return;
// // // // // // // // // // // // // // // // // // //     }
// // // // // // // // // // // // // // // // // // //     const suggestions = categories
// // // // // // // // // // // // // // // // // // //       .filter((c) => c.label.toLowerCase().includes(searchTerm.toLowerCase()))
// // // // // // // // // // // // // // // // // // //       .slice(0, 5);
// // // // // // // // // // // // // // // // // // //     setAutocompleteItems(suggestions);
// // // // // // // // // // // // // // // // // // //     setShowAutocomplete(suggestions.length > 0);
// // // // // // // // // // // // // // // // // // //   }, [searchTerm, categories]);

// // // // // // // // // // // // // // // // // // //   // Category select handler
// // // // // // // // // // // // // // // // // // //   const handleCategorySelect = (slug) => {
// // // // // // // // // // // // // // // // // // //     setSelectedCategory(slug);
// // // // // // // // // // // // // // // // // // //     setPage(1);
// // // // // // // // // // // // // // // // // // //     setPosts([]);
// // // // // // // // // // // // // // // // // // //     setSearchTerm("");
// // // // // // // // // // // // // // // // // // //     setDebouncedTerm("");
// // // // // // // // // // // // // // // // // // //     setShowAutocomplete(false);
// // // // // // // // // // // // // // // // // // //   };

// // // // // // // // // // // // // // // // // // //   // Autocomplete click handler
// // // // // // // // // // // // // // // // // // //   const handleAutocompleteSelect = (slug) => {
// // // // // // // // // // // // // // // // // // //     handleCategorySelect(slug);
// // // // // // // // // // // // // // // // // // //   };

// // // // // // // // // // // // // // // // // // //   // Dark mode toggle
// // // // // // // // // // // // // // // // // // //   const toggleDarkMode = () => setDarkMode((d) => !d);

// // // // // // // // // // // // // // // // // // //   // Scroll progress bar
// // // // // // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // // // // // //     const updateScrollProgress = () => {
// // // // // // // // // // // // // // // // // // //       if (!scrollProgressRef.current) return;
// // // // // // // // // // // // // // // // // // //       const scrollTop = window.scrollY;
// // // // // // // // // // // // // // // // // // //       const docHeight = document.body.scrollHeight - window.innerHeight;
// // // // // // // // // // // // // // // // // // //       const progress = Math.min((scrollTop / docHeight) * 100, 100);
// // // // // // // // // // // // // // // // // // //       scrollProgressRef.current.style.width = `${progress}%`;
// // // // // // // // // // // // // // // // // // //     };
// // // // // // // // // // // // // // // // // // //     window.addEventListener("scroll", updateScrollProgress);
// // // // // // // // // // // // // // // // // // //     return () => window.removeEventListener("scroll", updateScrollProgress);
// // // // // // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // // // // // //   // Sticky category tabs on scroll
// // // // // // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // // // // // //     const handleScroll = () => {
// // // // // // // // // // // // // // // // // // //       if (!stickyTabsRef.current) return;
// // // // // // // // // // // // // // // // // // //       stickyTabsRef.current.classList.toggle("sticky", window.scrollY > 150);
// // // // // // // // // // // // // // // // // // //     };
// // // // // // // // // // // // // // // // // // //     window.addEventListener("scroll", handleScroll);
// // // // // // // // // // // // // // // // // // //     return () => window.removeEventListener("scroll", handleScroll);
// // // // // // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // // // // // //   // Back to top button state
// // // // // // // // // // // // // // // // // // //   const [showTop, setShowTop] = useState(false);
// // // // // // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // // // // // //     const onScroll = () => setShowTop(window.scrollY > 300);
// // // // // // // // // // // // // // // // // // //     window.addEventListener("scroll", onScroll);
// // // // // // // // // // // // // // // // // // //     return () => window.removeEventListener("scroll", onScroll);
// // // // // // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // // // // // //   return (
// // // // // // // // // // // // // // // // // // //     <>
// // // // // // // // // // // // // // // // // // //       <Seo title="Home" description="Explore top articles and latest news" />
// // // // // // // // // // // // // // // // // // //       <div className={`app-container ${darkMode ? "dark" : ""}`}>
// // // // // // // // // // // // // // // // // // //         <div className="scroll-progress-bar" ref={scrollProgressRef} aria-hidden="true" />

// // // // // // // // // // // // // // // // // // //         <header>
// // // // // // // // // // // // // // // // // // //           <LiveNewsSection />
// // // // // // // // // // // // // // // // // // //           <button aria-label="Toggle dark mode" className="dark-mode-toggle" onClick={toggleDarkMode}>
// // // // // // // // // // // // // // // // // // //             {darkMode ? "ðŸŒž" : "ðŸŒ™"}
// // // // // // // // // // // // // // // // // // //           </button>
// // // // // // // // // // // // // // // // // // //         </header>

// // // // // // // // // // // // // // // // // // //         <TrendingPost />

// // // // // // // // // // // // // // // // // // //         <section className="search-category-wrapper">
// // // // // // // // // // // // // // // // // // //           <form
// // // // // // // // // // // // // // // // // // //             onSubmit={(e) => {
// // // // // // // // // // // // // // // // // // //               e.preventDefault();
// // // // // // // // // // // // // // // // // // //               setDebouncedTerm(searchTerm);
// // // // // // // // // // // // // // // // // // //             }}
// // // // // // // // // // // // // // // // // // //             className="search-form"
// // // // // // // // // // // // // // // // // // //             role="search"
// // // // // // // // // // // // // // // // // // //             aria-label="Search articles"
// // // // // // // // // // // // // // // // // // //           >
// // // // // // // // // // // // // // // // // // //             <input
// // // // // // // // // // // // // // // // // // //               type="search"
// // // // // // // // // // // // // // // // // // //               placeholder="Search articles..."
// // // // // // // // // // // // // // // // // // //               aria-label="Search articles"
// // // // // // // // // // // // // // // // // // //               value={searchTerm}
// // // // // // // // // // // // // // // // // // //               onChange={onSearchChange}
// // // // // // // // // // // // // // // // // // //               spellCheck={false}
// // // // // // // // // // // // // // // // // // //               aria-autocomplete="list"
// // // // // // // // // // // // // // // // // // //               aria-controls="search-autocomplete"
// // // // // // // // // // // // // // // // // // //               aria-expanded={showAutocomplete}
// // // // // // // // // // // // // // // // // // //               autoComplete="off"
// // // // // // // // // // // // // // // // // // //             />
// // // // // // // // // // // // // // // // // // //             <button type="submit">Search</button>
// // // // // // // // // // // // // // // // // // //             {showAutocomplete && (
// // // // // // // // // // // // // // // // // // //               <ul id="search-autocomplete" role="listbox" className="autocomplete-list">
// // // // // // // // // // // // // // // // // // //                 {autocompleteItems.map(({ slug, label }) => (
// // // // // // // // // // // // // // // // // // //                   <li
// // // // // // // // // // // // // // // // // // //                     key={slug}
// // // // // // // // // // // // // // // // // // //                     role="option"
// // // // // // // // // // // // // // // // // // //                     tabIndex={0}
// // // // // // // // // // // // // // // // // // //                     onClick={() => handleAutocompleteSelect(slug)}
// // // // // // // // // // // // // // // // // // //                     onKeyDown={(e) => (e.key === "Enter" || e.key === " ") && handleAutocompleteSelect(slug)}
// // // // // // // // // // // // // // // // // // //                   >
// // // // // // // // // // // // // // // // // // //                     {label}
// // // // // // // // // // // // // // // // // // //                   </li>
// // // // // // // // // // // // // // // // // // //                 ))}
// // // // // // // // // // // // // // // // // // //               </ul>
// // // // // // // // // // // // // // // // // // //             )}
// // // // // // // // // // // // // // // // // // //           </form>
// // // // // // // // // // // // // // // // // // //           <nav className="category-tabs" role="tablist" aria-label="Article categories" ref={stickyTabsRef}>
// // // // // // // // // // // // // // // // // // //             {categories.map(({ slug, label, postCount }) => (
// // // // // // // // // // // // // // // // // // //               <button
// // // // // // // // // // // // // // // // // // //                 key={slug}
// // // // // // // // // // // // // // // // // // //                 role="tab"
// // // // // // // // // // // // // // // // // // //                 aria-selected={slug === selectedCategory}
// // // // // // // // // // // // // // // // // // //                 className={slug === selectedCategory ? "active" : ""}
// // // // // // // // // // // // // // // // // // //                 onClick={() => handleCategorySelect(slug)}
// // // // // // // // // // // // // // // // // // //               >
// // // // // // // // // // // // // // // // // // //                 {label} {postCount > 0 && <span className="post-count">({postCount})</span>}
// // // // // // // // // // // // // // // // // // //               </button>
// // // // // // // // // // // // // // // // // // //             ))}
// // // // // // // // // // // // // // // // // // //           </nav>
// // // // // // // // // // // // // // // // // // //         </section>

// // // // // // // // // // // // // // // // // // //         <main aria-live="polite" aria-busy={loadingPosts}>
// // // // // // // // // // // // // // // // // // //           {error && <ErrorState msg={error} />}
// // // // // // // // // // // // // // // // // // //           <PostList posts={posts} layout="grid" />
// // // // // // // // // // // // // // // // // // //           {!loadingPosts && hasMore && (
// // // // // // // // // // // // // // // // // // //             <button className="load-more-btn" onClick={() => setPage((p) => p + 1)} aria-label="Load more posts">
// // // // // // // // // // // // // // // // // // //               Load More
// // // // // // // // // // // // // // // // // // //             </button>
// // // // // // // // // // // // // // // // // // //           )}
// // // // // // // // // // // // // // // // // // //           {loadingPosts && <Loader />}
// // // // // // // // // // // // // // // // // // //           <div ref={loadMoreRef} style={{ height: 1 }} />
// // // // // // // // // // // // // // // // // // //         </main>

// // // // // // // // // // // // // // // // // // //         {showTop && (
// // // // // // // // // // // // // // // // // // //           <button onClick={() => window.scrollTo({ top: 0, behavior: "smooth" })} className="back-to-top" aria-label="Back to top">
// // // // // // // // // // // // // // // // // // //             â†‘
// // // // // // // // // // // // // // // // // // //           </button>
// // // // // // // // // // // // // // // // // // //         )}
// // // // // // // // // // // // // // // // // // //       </div>

// // // // // // // // // // // // // // // // // // //       <style>{`
// // // // // // // // // // // // // // // // // // //         /* Container */
// // // // // // // // // // // // // // // // // // //         .app-container {
// // // // // // // // // // // // // // // // // // //           background: white;
// // // // // // // // // // // // // // // // // // //           color: #222;
// // // // // // // // // // // // // // // // // // //           min-height: 100vh;
// // // // // // // // // // // // // // // // // // //           font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
// // // // // // // // // // // // // // // // // // //           padding-bottom: 50px;
// // // // // // // // // // // // // // // // // // //           transition: background-color 0.3s ease, color 0.3s ease;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .app-container.dark {
// // // // // // // // // // // // // // // // // // //           background-color: #0f172a;
// // // // // // // // // // // // // // // // // // //           color: #cbd5e1;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         /* Scroll Progress Bar */
// // // // // // // // // // // // // // // // // // //         .scroll-progress-bar {
// // // // // // // // // // // // // // // // // // //           position: fixed;
// // // // // // // // // // // // // // // // // // //           top: 0;
// // // // // // // // // // // // // // // // // // //           left: 0;
// // // // // // // // // // // // // // // // // // //           height: 4px;
// // // // // // // // // // // // // // // // // // //           background-color: #2563eb;
// // // // // // // // // // // // // // // // // // //           width: 0%;
// // // // // // // // // // // // // // // // // // //           z-index: 10000;
// // // // // // // // // // // // // // // // // // //           transition: width 0.2s ease;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         /* Dark mode toggle */
// // // // // // // // // // // // // // // // // // //         .dark-mode-toggle {
// // // // // // // // // // // // // // // // // // //           position: absolute;
// // // // // // // // // // // // // // // // // // //           top: 10px;
// // // // // // // // // // // // // // // // // // //           right: 20px;
// // // // // // // // // // // // // // // // // // //           font-size: 1.8rem;
// // // // // // // // // // // // // // // // // // //           background: none;
// // // // // // // // // // // // // // // // // // //           border: none;
// // // // // // // // // // // // // // // // // // //           cursor: pointer;
// // // // // // // // // // // // // // // // // // //           color: inherit;
// // // // // // // // // // // // // // // // // // //           user-select: none;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         /* Search and category tabs */
// // // // // // // // // // // // // // // // // // //         .search-category-wrapper {
// // // // // // // // // // // // // // // // // // //           max-width: 1100px;
// // // // // // // // // // // // // // // // // // //           margin: 2rem auto;
// // // // // // // // // // // // // // // // // // //           padding: 0 15px;
// // // // // // // // // // // // // // // // // // //           position: relative;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .search-form {
// // // // // // // // // // // // // // // // // // //           display: flex;
// // // // // // // // // // // // // // // // // // //           margin-bottom: 1rem;
// // // // // // // // // // // // // // // // // // //           gap: 8px;
// // // // // // // // // // // // // // // // // // //           position: relative;
// // // // // // // // // // // // // // // // // // //           z-index: 10;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .search-form input[type="search"] {
// // // // // // // // // // // // // // // // // // //           flex-grow: 1;
// // // // // // // // // // // // // // // // // // //           padding: 10px 14px;
// // // // // // // // // // // // // // // // // // //           font-size: 1rem;
// // // // // // // // // // // // // // // // // // //           border-radius: 8px;
// // // // // // // // // // // // // // // // // // //           border: 1px solid #ccc;
// // // // // // // // // // // // // // // // // // //           outline-offset: 2px;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .search-form button {
// // // // // // // // // // // // // // // // // // //           background-color: #2563eb;
// // // // // // // // // // // // // // // // // // //           color: white;
// // // // // // // // // // // // // // // // // // //           font-weight: 700;
// // // // // // // // // // // // // // // // // // //           border: none;
// // // // // // // // // // // // // // // // // // //           padding: 10px 18px;
// // // // // // // // // // // // // // // // // // //           border-radius: 8px;
// // // // // // // // // // // // // // // // // // //           cursor: pointer;
// // // // // // // // // // // // // // // // // // //           transition: background-color 0.2s ease;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .search-form button:hover,
// // // // // // // // // // // // // // // // // // //         .search-form button:focus-visible {
// // // // // // // // // // // // // // // // // // //           background-color: #1e40af;
// // // // // // // // // // // // // // // // // // //           outline: none;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .autocomplete-list {
// // // // // // // // // // // // // // // // // // //           position: absolute;
// // // // // // // // // // // // // // // // // // //           top: 100%;
// // // // // // // // // // // // // // // // // // //           left: 0;
// // // // // // // // // // // // // // // // // // //           right: 0;
// // // // // // // // // // // // // // // // // // //           background: white;
// // // // // // // // // // // // // // // // // // //           border: 1px solid #cbd5e1;
// // // // // // // // // // // // // // // // // // //           border-radius: 8px;
// // // // // // // // // // // // // // // // // // //           max-height: 200px;
// // // // // // // // // // // // // // // // // // //           overflow-y: auto;
// // // // // // // // // // // // // // // // // // //           box-shadow: 0 4px 12px rgba(0,0,0,0.1);
// // // // // // // // // // // // // // // // // // //           z-index: 20;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .autocomplete-list li {
// // // // // // // // // // // // // // // // // // //           padding: 8px 15px;
// // // // // // // // // // // // // // // // // // //           cursor: pointer;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .autocomplete-list li:hover,
// // // // // // // // // // // // // // // // // // //         .autocomplete-list li:focus {
// // // // // // // // // // // // // // // // // // //           background-color: #2563eb;
// // // // // // // // // // // // // // // // // // //           color: white;
// // // // // // // // // // // // // // // // // // //           outline: none;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         /* Category Tabs */
// // // // // // // // // // // // // // // // // // //         .category-tabs {
// // // // // // // // // // // // // // // // // // //           display: flex;
// // // // // // // // // // // // // // // // // // //           gap: 12px;
// // // // // // // // // // // // // // // // // // //           overflow-x: auto;
// // // // // // // // // // // // // // // // // // //           padding-bottom: 8px;
// // // // // // // // // // // // // // // // // // //           background-color: inherit;
// // // // // // // // // // // // // // // // // // //           position: relative;
// // // // // // // // // // // // // // // // // // //           transition: box-shadow 0.3s ease;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .category-tabs.sticky {
// // // // // // // // // // // // // // // // // // //           position: fixed;
// // // // // // // // // // // // // // // // // // //           top: 60px;
// // // // // // // // // // // // // // // // // // //           left: 50%;
// // // // // // // // // // // // // // // // // // //           transform: translateX(-50%);
// // // // // // // // // // // // // // // // // // //           max-width: 1100px;
// // // // // // // // // // // // // // // // // // //           width: 95%;
// // // // // // // // // // // // // // // // // // //           padding: 10px 12px;
// // // // // // // // // // // // // // // // // // //           border-radius: 12px;
// // // // // // // // // // // // // // // // // // //           box-shadow: 0 2px 12px rgba(0,0,0,0.15);
// // // // // // // // // // // // // // // // // // //           background-color: var(--background-color, white);
// // // // // // // // // // // // // // // // // // //           z-index: 999;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .category-tabs button {
// // // // // // // // // // // // // // // // // // //           cursor: pointer;
// // // // // // // // // // // // // // // // // // //           background: none;
// // // // // // // // // // // // // // // // // // //           border: none;
// // // // // // // // // // // // // // // // // // //           padding: 8px 18px;
// // // // // // // // // // // // // // // // // // //           font-weight: 600;
// // // // // // // // // // // // // // // // // // //           border-radius: 9999px;
// // // // // // // // // // // // // // // // // // //           color: #4b5563;
// // // // // // // // // // // // // // // // // // //           border: 1.5px solid transparent;
// // // // // // // // // // // // // // // // // // //           white-space: nowrap;
// // // // // // // // // // // // // // // // // // //           transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .category-tabs button.active {
// // // // // // // // // // // // // // // // // // //           background-color: #2563eb;
// // // // // // // // // // // // // // // // // // //           color: white;
// // // // // // // // // // // // // // // // // // //           border-color: #2563eb;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .category-tabs button:hover:not(.active),
// // // // // // // // // // // // // // // // // // //         .category-tabs button:focus-visible:not(.active) {
// // // // // // // // // // // // // // // // // // //           border-color: #2563eb;
// // // // // // // // // // // // // // // // // // //           outline: none;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .post-count {
// // // // // // // // // // // // // // // // // // //           font-weight: 400;
// // // // // // // // // // // // // // // // // // //           font-size: 0.8rem;
// // // // // // // // // // // // // // // // // // //           color: inherit;
// // // // // // // // // // // // // // // // // // //           margin-left: 6px;
// // // // // // // // // // // // // // // // // // //           user-select: none;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         main {
// // // // // // // // // // // // // // // // // // //           max-width: 1100px;
// // // // // // // // // // // // // // // // // // //           margin: 0 auto 3rem;
// // // // // // // // // // // // // // // // // // //           padding: 0 15px;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         /* Load More Button */
// // // // // // // // // // // // // // // // // // //         .load-more-btn {
// // // // // // // // // // // // // // // // // // //           display: block;
// // // // // // // // // // // // // // // // // // //           margin: 2rem auto 0;
// // // // // // // // // // // // // // // // // // //           padding: 10px 20px;
// // // // // // // // // // // // // // // // // // //           background-color: #2563eb;
// // // // // // // // // // // // // // // // // // //           color: white;
// // // // // // // // // // // // // // // // // // //           font-weight: 700;
// // // // // // // // // // // // // // // // // // //           border: none;
// // // // // // // // // // // // // // // // // // //           border-radius: 8px;
// // // // // // // // // // // // // // // // // // //           cursor: pointer;
// // // // // // // // // // // // // // // // // // //           transition: background-color 0.3s ease;
// // // // // // // // // // // // // // // // // // //           user-select: none;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .load-more-btn:hover,
// // // // // // // // // // // // // // // // // // //         .load-more-btn:focus-visible {
// // // // // // // // // // // // // // // // // // //           background-color: #1e40af;
// // // // // // // // // // // // // // // // // // //           outline: none;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         /* Back to top */
// // // // // // // // // // // // // // // // // // //         .back-to-top {
// // // // // // // // // // // // // // // // // // //           position: fixed;
// // // // // // // // // // // // // // // // // // //           bottom: 24px;
// // // // // // // // // // // // // // // // // // //           right: 24px;
// // // // // // // // // // // // // // // // // // //           background-color: #2563eb;
// // // // // // // // // // // // // // // // // // //           color: white;
// // // // // // // // // // // // // // // // // // //           border-radius: 50%;
// // // // // // // // // // // // // // // // // // //           border: none;
// // // // // // // // // // // // // // // // // // //           width: 44px;
// // // // // // // // // // // // // // // // // // //           height: 44px;
// // // // // // // // // // // // // // // // // // //           font-size: 1.5rem;
// // // // // // // // // // // // // // // // // // //           cursor: pointer;
// // // // // // // // // // // // // // // // // // //           box-shadow: 0 3px 8px rgba(0,0,0,0.2);
// // // // // // // // // // // // // // // // // // //           transition: background-color 0.3s ease;
// // // // // // // // // // // // // // // // // // //           z-index: 1000;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .back-to-top:hover,
// // // // // // // // // // // // // // // // // // //         .back-to-top:focus-visible {
// // // // // // // // // // // // // // // // // // //           background-color: #1e40af;
// // // // // // // // // // // // // // // // // // //           outline: none;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         /* Dark mode */
// // // // // // // // // // // // // // // // // // //         .dark {
// // // // // // // // // // // // // // // // // // //           --background-color: #0f172a;
// // // // // // // // // // // // // // // // // // //           color: #cbd5e1;
// // // // // // // // // // // // // // // // // // //           background-color: var(--background-color);
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .dark .search-form input[type="search"],
// // // // // // // // // // // // // // // // // // //         .dark .autocomplete-list {
// // // // // // // // // // // // // // // // // // //           background-color: #1e293b;
// // // // // // // // // // // // // // // // // // //           color: #cbd5e1;
// // // // // // // // // // // // // // // // // // //           border-color: #3b82f6;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .dark .autocomplete-list li:hover,
// // // // // // // // // // // // // // // // // // //         .dark .autocomplete-list li:focus {
// // // // // // // // // // // // // // // // // // //           background-color: #2563eb;
// // // // // // // // // // // // // // // // // // //           color: white;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .dark .category-tabs {
// // // // // // // // // // // // // // // // // // //           background-color: var(--background-color);
// // // // // // // // // // // // // // // // // // //           border-color: #2563eb;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //         .dark .category-tabs button.active {
// // // // // // // // // // // // // // // // // // //           background-color: #3b82f6;
// // // // // // // // // // // // // // // // // // //           border-color: #3b82f6;
// // // // // // // // // // // // // // // // // // //           color: white;
// // // // // // // // // // // // // // // // // // //         }
// // // // // // // // // // // // // // // // // // //       `}</style>
// // // // // // // // // // // // // // // // // // //     </>
// // // // // // // // // // // // // // // // // // //   );
// // // // // // // // // // // // // // // // // // // };

// // // // // // // // // // // // // // // // // // // export default Home;



// // // // // // // // // // // // // // // // import React, { useEffect, useState, useRef, useCallback } from "react";
// // // // // // // // // // // // // // // // import Seo from "../components/Seo.jsx";
// // // // // // // // // // // // // // // // import PostList from "../components/PostList.jsx";
// // // // // // // // // // // // // // // // import { Loader, ErrorState } from "../components/Loader.jsx";
// // // // // // // // // // // // // // // // import LiveNewsSection from "../components/LiveNewsSection.jsx";
// // // // // // // // // // // // // // // // import TrendingPost from "../components/TrendingPost.jsx";
// // // // // // // // // // // // // // // // import debounce from "lodash.debounce";
// // // // // // // // // // // // // // // // import "./Home.css";

// // // // // // // // // // // // // // // // const POSTS_PER_PAGE = 10;

// // // // // // // // // // // // // // // // const Home = () => {
// // // // // // // // // // // // // // // //   const [categories, setCategories] = useState([{ slug: "all", label: "All", postCount: 0 }]);
// // // // // // // // // // // // // // // //   const [selectedCategory, setSelectedCategory] = useState("all");
// // // // // // // // // // // // // // // //   const [searchTerm, setSearchTerm] = useState("");
// // // // // // // // // // // // // // // //   const [debouncedTerm, setDebouncedTerm] = useState("");
// // // // // // // // // // // // // // // //   const [posts, setPosts] = useState([]);
// // // // // // // // // // // // // // // //   const [page, setPage] = useState(1);
// // // // // // // // // // // // // // // //   const [hasMore, setHasMore] = useState(true);
// // // // // // // // // // // // // // // //   const [loadingPosts, setLoadingPosts] = useState(false);
// // // // // // // // // // // // // // // //   const [error, setError] = useState(null);
// // // // // // // // // // // // // // // //   const [autocompleteItems, setAutocompleteItems] = useState([]);
// // // // // // // // // // // // // // // //   const [showAutocomplete, setShowAutocomplete] = useState(false);
// // // // // // // // // // // // // // // //   const [darkMode, setDarkMode] = useState(false);
// // // // // // // // // // // // // // // //   const loadMoreRef = useRef(null);
// // // // // // // // // // // // // // // //   const scrollProgressRef = useRef(null);
// // // // // // // // // // // // // // // //   const stickyTabsRef = useRef(null);

// // // // // // // // // // // // // // // //   // Fetch categories
// // // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // // //     fetch("http://localhost:4000/api/categories")
// // // // // // // // // // // // // // // //       .then(res => res.json())
// // // // // // // // // // // // // // // //       .then(data => {
// // // // // // // // // // // // // // // //         const cats = data.map(c => ({ slug: c.slug, label: c.name, postCount: c.count || 0 }));
// // // // // // // // // // // // // // // //         setCategories([{ slug: "all", label: "All", postCount: cats.reduce((a,b) => a + b.postCount, 0) }, ...cats]);
// // // // // // // // // // // // // // // //       });
// // // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // // //   // Debounced search
// // // // // // // // // // // // // // // //   const debouncedSearch = useCallback(debounce(val => {
// // // // // // // // // // // // // // // //     setDebouncedTerm(val);
// // // // // // // // // // // // // // // //     setPage(1);
// // // // // // // // // // // // // // // //     setPosts([]);
// // // // // // // // // // // // // // // //   }, 400), []);

// // // // // // // // // // // // // // // //   const onSearchChange = (e) => {
// // // // // // // // // // // // // // // //     setSearchTerm(e.target.value);
// // // // // // // // // // // // // // // //     debouncedSearch(e.target.value);
// // // // // // // // // // // // // // // //   };

// // // // // // // // // // // // // // // //   const fetchPosts = useCallback(() => {
// // // // // // // // // // // // // // // //     setLoadingPosts(true);
// // // // // // // // // // // // // // // //     setError(null);

// // // // // // // // // // // // // // // //     let baseUrl = selectedCategory === "all"
// // // // // // // // // // // // // // // //       ? `http://localhost:4000/api/posts`
// // // // // // // // // // // // // // // //       : `http://localhost:4000/api/posts?category=${selectedCategory}`;

// // // // // // // // // // // // // // // //     const url = new URL(baseUrl);
// // // // // // // // // // // // // // // //     if (debouncedTerm.trim()) url.searchParams.set("q", debouncedTerm.trim());
// // // // // // // // // // // // // // // //     url.searchParams.set("page", page);
// // // // // // // // // // // // // // // //     url.searchParams.set("limit", POSTS_PER_PAGE);

// // // // // // // // // // // // // // // //     fetch(url.toString())
// // // // // // // // // // // // // // // //       .then(res => { if(!res.ok) throw new Error("Failed to load posts"); return res.json(); })
// // // // // // // // // // // // // // // //       .then(data => {
// // // // // // // // // // // // // // // //         const newPosts = selectedCategory === "all" ? data.results || [] : data.posts || [];
// // // // // // // // // // // // // // // //         setPosts(prev => (page === 1 ? newPosts : [...prev, ...newPosts]));
// // // // // // // // // // // // // // // //         setHasMore(newPosts.length === POSTS_PER_PAGE);
// // // // // // // // // // // // // // // //         setLoadingPosts(false);
// // // // // // // // // // // // // // // //       })
// // // // // // // // // // // // // // // //       .catch(e => { setError(e.message); setLoadingPosts(false); });
// // // // // // // // // // // // // // // //   }, [page, selectedCategory, debouncedTerm]);

// // // // // // // // // // // // // // // //   useEffect(() => { fetchPosts(); }, [fetchPosts]);

// // // // // // // // // // // // // // // //   // Infinite scroll
// // // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // // //     if(!hasMore || loadingPosts) return;
// // // // // // // // // // // // // // // //     const observer = new IntersectionObserver(([entry]) => { if(entry.isIntersecting) setPage(p => p+1); }, { rootMargin: "200px" });
// // // // // // // // // // // // // // // //     const current = loadMoreRef.current;
// // // // // // // // // // // // // // // //     if(current) observer.observe(current);
// // // // // // // // // // // // // // // //     return () => current && observer.unobserve(current);
// // // // // // // // // // // // // // // //   }, [hasMore, loadingPosts]);

// // // // // // // // // // // // // // // //   // Autocomplete suggestions
// // // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // // //     if(!searchTerm.trim()) { setAutocompleteItems([]); setShowAutocomplete(false); return; }
// // // // // // // // // // // // // // // //     const suggestions = posts
// // // // // // // // // // // // // // // //       .filter(p => p.title.toLowerCase().includes(searchTerm.toLowerCase()))
// // // // // // // // // // // // // // // //       .slice(0, 5);
// // // // // // // // // // // // // // // //     setAutocompleteItems(suggestions);
// // // // // // // // // // // // // // // //     setShowAutocomplete(suggestions.length > 0);
// // // // // // // // // // // // // // // //   }, [searchTerm, posts]);

// // // // // // // // // // // // // // // //   const handleCategorySelect = slug => {
// // // // // // // // // // // // // // // //     setSelectedCategory(slug);
// // // // // // // // // // // // // // // //     setPage(1);
// // // // // // // // // // // // // // // //     setPosts([]);
// // // // // // // // // // // // // // // //     setSearchTerm("");
// // // // // // // // // // // // // // // //     setDebouncedTerm("");
// // // // // // // // // // // // // // // //     setShowAutocomplete(false);
// // // // // // // // // // // // // // // //   };

// // // // // // // // // // // // // // // //   const toggleDarkMode = () => setDarkMode(d => !d);

// // // // // // // // // // // // // // // //   // Scroll progress bar
// // // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // // //     const updateScrollProgress = () => {
// // // // // // // // // // // // // // // //       if(!scrollProgressRef.current) return;
// // // // // // // // // // // // // // // //       const scrollTop = window.scrollY;
// // // // // // // // // // // // // // // //       const docHeight = document.body.scrollHeight - window.innerHeight;
// // // // // // // // // // // // // // // //       const progress = Math.min((scrollTop / docHeight) * 100, 100);
// // // // // // // // // // // // // // // //       scrollProgressRef.current.style.width = `${progress}%`;
// // // // // // // // // // // // // // // //     };
// // // // // // // // // // // // // // // //     window.addEventListener("scroll", updateScrollProgress);
// // // // // // // // // // // // // // // //     return () => window.removeEventListener("scroll", updateScrollProgress);
// // // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // // //   // Sticky tabs
// // // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // // //     const handleScroll = () => { stickyTabsRef.current?.classList.toggle("sticky", window.scrollY > 150); };
// // // // // // // // // // // // // // // //     window.addEventListener("scroll", handleScroll);
// // // // // // // // // // // // // // // //     return () => window.removeEventListener("scroll", handleScroll);
// // // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // // //   // Back to top
// // // // // // // // // // // // // // // //   const [showTop, setShowTop] = useState(false);
// // // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // // //     const onScroll = () => setShowTop(window.scrollY > 300);
// // // // // // // // // // // // // // // //     window.addEventListener("scroll", onScroll);
// // // // // // // // // // // // // // // //     return () => window.removeEventListener("scroll", onScroll);
// // // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // // //   return (
// // // // // // // // // // // // // // // //     <>
// // // // // // // // // // // // // // // //       <Seo title="Home" description="Explore top articles and latest news" />
// // // // // // // // // // // // // // // //       <div className={`home-container ${darkMode ? "dark" : ""}`}>
// // // // // // // // // // // // // // // //         <div className="scroll-progress-bar" ref={scrollProgressRef}></div>

// // // // // // // // // // // // // // // //         <header>
// // // // // // // // // // // // // // // //           <LiveNewsSection />
// // // // // // // // // // // // // // // //           <button className="dark-mode-toggle" onClick={toggleDarkMode}>{darkMode ? "ðŸŒž" : "ðŸŒ™"}</button>
// // // // // // // // // // // // // // // //         </header>

// // // // // // // // // // // // // // // //         <TrendingPost />

// // // // // // // // // // // // // // // //         <section className="search-category-wrapper">
// // // // // // // // // // // // // // // //           <form className="search-form" onSubmit={e => { e.preventDefault(); setDebouncedTerm(searchTerm); }}>
// // // // // // // // // // // // // // // //             <input type="search" placeholder="Search articles..." value={searchTerm} onChange={onSearchChange} autoComplete="off"/>
// // // // // // // // // // // // // // // //             <button type="submit">Search</button>
// // // // // // // // // // // // // // // //             {showAutocomplete && <ul className="autocomplete-list">
// // // // // // // // // // // // // // // //               {autocompleteItems.map(p => <li key={p._id} onClick={() => setDebouncedTerm(p.title)}>{p.title}</li>)}
// // // // // // // // // // // // // // // //             </ul>}
// // // // // // // // // // // // // // // //           </form>
// // // // // // // // // // // // // // // //           <nav className="category-tabs" ref={stickyTabsRef}>
// // // // // // // // // // // // // // // //             {categories.map(c => (
// // // // // // // // // // // // // // // //               <button key={c.slug} className={selectedCategory === c.slug ? "active" : ""} onClick={() => handleCategorySelect(c.slug)}>
// // // // // // // // // // // // // // // //                 {c.label} {c.postCount>0 && <span className="post-count">({c.postCount})</span>}
// // // // // // // // // // // // // // // //               </button>
// // // // // // // // // // // // // // // //             ))}
// // // // // // // // // // // // // // // //           </nav>
// // // // // // // // // // // // // // // //         </section>

// // // // // // // // // // // // // // // //         <main>
// // // // // // // // // // // // // // // //           {error && <ErrorState msg={error} />}
// // // // // // // // // // // // // // // //           <PostList posts={posts} layout="grid" />
// // // // // // // // // // // // // // // //           {!loadingPosts && hasMore && <button className="load-more-btn" onClick={() => setPage(p => p+1)}>Load More</button>}
// // // // // // // // // // // // // // // //           {loadingPosts && <Loader />}
// // // // // // // // // // // // // // // //           <div ref={loadMoreRef} style={{height:1}} />
// // // // // // // // // // // // // // // //         </main>

// // // // // // // // // // // // // // // //         {showTop && <button className="back-to-top" onClick={() => window.scrollTo({top:0, behavior:"smooth"})}>â†‘</button>}
// // // // // // // // // // // // // // // //       </div>
// // // // // // // // // // // // // // // //     </>
// // // // // // // // // // // // // // // //   );
// // // // // // // // // // // // // // // // };

// // // // // // // // // // // // // // // // export default Home;




// // // // // // // // // // // // // // // import React, { useEffect, useState, useRef, useCallback } from "react";
// // // // // // // // // // // // // // // import Seo from "../components/Seo.jsx";
// // // // // // // // // // // // // // // import PostList from "../components/PostList.jsx";
// // // // // // // // // // // // // // // import { Loader, ErrorState } from "../components/Loader.jsx";
// // // // // // // // // // // // // // // import LiveNewsSection from "../components/LiveNewsSection.jsx";
// // // // // // // // // // // // // // // import TrendingPost from "../components/TrendingPost.jsx";
// // // // // // // // // // // // // // // import debounce from "lodash.debounce";
// // // // // // // // // // // // // // // import "./Home.css";

// // // // // // // // // // // // // // // const POSTS_PER_PAGE = 10;

// // // // // // // // // // // // // // // const Home = () => {
// // // // // // // // // // // // // // //   const [categories, setCategories] = useState([{ slug: "all", label: "All", postCount: 0 }]);
// // // // // // // // // // // // // // //   const [selectedCategory, setSelectedCategory] = useState("all");
// // // // // // // // // // // // // // //   const [searchTerm, setSearchTerm] = useState("");
// // // // // // // // // // // // // // //   const [debouncedTerm, setDebouncedTerm] = useState("");
// // // // // // // // // // // // // // //   const [posts, setPosts] = useState([]);
// // // // // // // // // // // // // // //   const [page, setPage] = useState(1);
// // // // // // // // // // // // // // //   const [hasMore, setHasMore] = useState(true);
// // // // // // // // // // // // // // //   const [loadingPosts, setLoadingPosts] = useState(false);
// // // // // // // // // // // // // // //   const [error, setError] = useState(null);
// // // // // // // // // // // // // // //   const [autocompleteItems, setAutocompleteItems] = useState([]);
// // // // // // // // // // // // // // //   const [showAutocomplete, setShowAutocomplete] = useState(false);
// // // // // // // // // // // // // // //   const [darkMode, setDarkMode] = useState(false);
// // // // // // // // // // // // // // //   const loadMoreRef = useRef(null);
// // // // // // // // // // // // // // //   const scrollProgressRef = useRef(null);
// // // // // // // // // // // // // // //   const stickyTabsRef = useRef(null);

// // // // // // // // // // // // // // //   // Fetch categories
// // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // //     fetch("http://localhost:4000/api/categories")
// // // // // // // // // // // // // // //       .then(res => res.json())
// // // // // // // // // // // // // // //       .then(data => {
// // // // // // // // // // // // // // //         const cats = data.map(c => ({ slug: c.slug, label: c.name, postCount: c.count || 0 }));
// // // // // // // // // // // // // // //         setCategories([{ slug: "all", label: "All", postCount: cats.reduce((a,b) => a + b.postCount, 0) }, ...cats]);
// // // // // // // // // // // // // // //       });
// // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // //   // Debounced search
// // // // // // // // // // // // // // //   const debouncedSearch = useCallback(debounce(val => {
// // // // // // // // // // // // // // //     setDebouncedTerm(val);
// // // // // // // // // // // // // // //     setPage(1);
// // // // // // // // // // // // // // //     setPosts([]);
// // // // // // // // // // // // // // //   }, 400), []);

// // // // // // // // // // // // // // //   const onSearchChange = (e) => {
// // // // // // // // // // // // // // //     setSearchTerm(e.target.value);
// // // // // // // // // // // // // // //     debouncedSearch(e.target.value);
// // // // // // // // // // // // // // //   };

// // // // // // // // // // // // // // //   const fetchPosts = useCallback(() => {
// // // // // // // // // // // // // // //     setLoadingPosts(true);
// // // // // // // // // // // // // // //     setError(null);

// // // // // // // // // // // // // // //     let baseUrl = selectedCategory === "all"
// // // // // // // // // // // // // // //       ? `http://localhost:4000/api/posts`
// // // // // // // // // // // // // // //       : `http://localhost:4000/api/posts?category=${selectedCategory}`;

// // // // // // // // // // // // // // //     const url = new URL(baseUrl);
// // // // // // // // // // // // // // //     if (debouncedTerm.trim()) url.searchParams.set("q", debouncedTerm.trim());
// // // // // // // // // // // // // // //     url.searchParams.set("page", page);
// // // // // // // // // // // // // // //     url.searchParams.set("limit", POSTS_PER_PAGE);

// // // // // // // // // // // // // // //     fetch(url.toString())
// // // // // // // // // // // // // // //       .then(res => { if(!res.ok) throw new Error("Failed to load posts"); return res.json(); })
// // // // // // // // // // // // // // //       .then(data => {
// // // // // // // // // // // // // // //         const newPosts = selectedCategory === "all" ? data.results || [] : data.posts || [];
// // // // // // // // // // // // // // //         setPosts(prev => (page === 1 ? newPosts : [...prev, ...newPosts]));
// // // // // // // // // // // // // // //         setHasMore(newPosts.length === POSTS_PER_PAGE);
// // // // // // // // // // // // // // //         setLoadingPosts(false);
// // // // // // // // // // // // // // //       })
// // // // // // // // // // // // // // //       .catch(e => { setError(e.message); setLoadingPosts(false); });
// // // // // // // // // // // // // // //   }, [page, selectedCategory, debouncedTerm]);

// // // // // // // // // // // // // // //   useEffect(() => { fetchPosts(); }, [fetchPosts]);

// // // // // // // // // // // // // // //   // Infinite scroll
// // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // //     if(!hasMore || loadingPosts) return;
// // // // // // // // // // // // // // //     const observer = new IntersectionObserver(([entry]) => { if(entry.isIntersecting) setPage(p => p+1); }, { rootMargin: "200px" });
// // // // // // // // // // // // // // //     const current = loadMoreRef.current;
// // // // // // // // // // // // // // //     if(current) observer.observe(current);
// // // // // // // // // // // // // // //     return () => current && observer.unobserve(current);
// // // // // // // // // // // // // // //   }, [hasMore, loadingPosts]);

// // // // // // // // // // // // // // //   // Autocomplete suggestions
// // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // //     if(!searchTerm.trim()) { setAutocompleteItems([]); setShowAutocomplete(false); return; }
// // // // // // // // // // // // // // //     const suggestions = posts
// // // // // // // // // // // // // // //       .filter(p => p.title.toLowerCase().includes(searchTerm.toLowerCase()))
// // // // // // // // // // // // // // //       .slice(0, 5);
// // // // // // // // // // // // // // //     setAutocompleteItems(suggestions);
// // // // // // // // // // // // // // //     setShowAutocomplete(suggestions.length > 0);
// // // // // // // // // // // // // // //   }, [searchTerm, posts]);

// // // // // // // // // // // // // // //   const handleCategorySelect = slug => {
// // // // // // // // // // // // // // //     setSelectedCategory(slug);
// // // // // // // // // // // // // // //     setPage(1);
// // // // // // // // // // // // // // //     setPosts([]);
// // // // // // // // // // // // // // //     setSearchTerm("");
// // // // // // // // // // // // // // //     setDebouncedTerm("");
// // // // // // // // // // // // // // //     setShowAutocomplete(false);
// // // // // // // // // // // // // // //   };

// // // // // // // // // // // // // // //   const toggleDarkMode = () => setDarkMode(d => !d);

// // // // // // // // // // // // // // //   // Scroll progress bar
// // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // //     const updateScrollProgress = () => {
// // // // // // // // // // // // // // //       if(!scrollProgressRef.current) return;
// // // // // // // // // // // // // // //       const scrollTop = window.scrollY;
// // // // // // // // // // // // // // //       const docHeight = document.body.scrollHeight - window.innerHeight;
// // // // // // // // // // // // // // //       const progress = Math.min((scrollTop / docHeight) * 100, 100);
// // // // // // // // // // // // // // //       scrollProgressRef.current.style.width = `${progress}%`;
// // // // // // // // // // // // // // //     };
// // // // // // // // // // // // // // //     window.addEventListener("scroll", updateScrollProgress);
// // // // // // // // // // // // // // //     return () => window.removeEventListener("scroll", updateScrollProgress);
// // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // //   // Sticky tabs
// // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // //     const handleScroll = () => { stickyTabsRef.current?.classList.toggle("sticky", window.scrollY > 150); };
// // // // // // // // // // // // // // //     window.addEventListener("scroll", handleScroll);
// // // // // // // // // // // // // // //     return () => window.removeEventListener("scroll", handleScroll);
// // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // //   // Back to top
// // // // // // // // // // // // // // //   const [showTop, setShowTop] = useState(false);
// // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // //     const onScroll = () => setShowTop(window.scrollY > 300);
// // // // // // // // // // // // // // //     window.addEventListener("scroll", onScroll);
// // // // // // // // // // // // // // //     return () => window.removeEventListener("scroll", onScroll);
// // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // //   return (
// // // // // // // // // // // // // // //     <>
// // // // // // // // // // // // // // //       <Seo title="Home" description="Explore top articles and latest news" />
// // // // // // // // // // // // // // //       <div className={`home-container ${darkMode ? "dark" : ""}`}>
        
// // // // // // // // // // // // // // //         {/* Progress bar */}
// // // // // // // // // // // // // // //         <div className="scroll-progress-bar" ref={scrollProgressRef}></div>

// // // // // // // // // // // // // // //         {/* Hero Section */}
// // // // // // // // // // // // // // //         <section className="hero-banner">
// // // // // // // // // // // // // // //           <div className="hero-content">
// // // // // // // // // // // // // // //             <h1>Discover. Learn. Stay Ahead.</h1>
// // // // // // // // // // // // // // //             <p>Your one-stop hub for latest articles, tech insights & trending news.</p>
// // // // // // // // // // // // // // //             <form className="search-form" onSubmit={e => { e.preventDefault(); setDebouncedTerm(searchTerm); }}>
// // // // // // // // // // // // // // //               <input type="search" placeholder="Search articles..." value={searchTerm} onChange={onSearchChange} autoComplete="off"/>
// // // // // // // // // // // // // // //               <button type="submit">ðŸ”</button>
// // // // // // // // // // // // // // //               {showAutocomplete && (
// // // // // // // // // // // // // // //                 <ul className="autocomplete-list">
// // // // // // // // // // // // // // //                   {autocompleteItems.map(p => (
// // // // // // // // // // // // // // //                     <li key={p._id} onClick={() => setDebouncedTerm(p.title)}>{p.title}</li>
// // // // // // // // // // // // // // //                   ))}
// // // // // // // // // // // // // // //                 </ul>
// // // // // // // // // // // // // // //               )}
// // // // // // // // // // // // // // //             </form>
// // // // // // // // // // // // // // //           </div>
// // // // // // // // // // // // // // //           <button className="dark-mode-toggle" onClick={toggleDarkMode}>
// // // // // // // // // // // // // // //             {darkMode ? "ðŸŒž Light" : "ðŸŒ™ Dark"}
// // // // // // // // // // // // // // //           </button>
// // // // // // // // // // // // // // //         </section>

// // // // // // // // // // // // // // //         {/* Live News + Trending */}
// // // // // // // // // // // // // // //         <LiveNewsSection />
// // // // // // // // // // // // // // //         <TrendingPost />

// // // // // // // // // // // // // // //         {/* Categories */}
// // // // // // // // // // // // // // //         <nav className="category-tabs" ref={stickyTabsRef}>
// // // // // // // // // // // // // // //           {categories.map(c => (
// // // // // // // // // // // // // // //             <button key={c.slug} className={selectedCategory === c.slug ? "active" : ""} onClick={() => handleCategorySelect(c.slug)}>
// // // // // // // // // // // // // // //               {c.label} {c.postCount>0 && <span className="post-count">({c.postCount})</span>}
// // // // // // // // // // // // // // //             </button>
// // // // // // // // // // // // // // //           ))}
// // // // // // // // // // // // // // //         </nav>

// // // // // // // // // // // // // // //         {/* Main Content */}
// // // // // // // // // // // // // // //         <main className="content-layout">
// // // // // // // // // // // // // // //           <section className="main-feed">
// // // // // // // // // // // // // // //             {error && <ErrorState msg={error} />}
// // // // // // // // // // // // // // //             <PostList posts={posts} layout="grid" />
// // // // // // // // // // // // // // //             {!loadingPosts && hasMore && (
// // // // // // // // // // // // // // //               <button className="load-more-btn" onClick={() => setPage(p => p+1)}>Load More</button>
// // // // // // // // // // // // // // //             )}
// // // // // // // // // // // // // // //             {loadingPosts && <Loader />}
// // // // // // // // // // // // // // //             <div ref={loadMoreRef} style={{height:1}} />
// // // // // // // // // // // // // // //           </section>

// // // // // // // // // // // // // // //           {/* Sidebar Widgets */}
// // // // // // // // // // // // // // //           <aside className="sidebar">
// // // // // // // // // // // // // // //             <div className="widget">
// // // // // // // // // // // // // // //               <h3>ðŸ“Œ Popular Tags</h3>
// // // // // // // // // // // // // // //               <div className="tags">
// // // // // // // // // // // // // // //                 <span>#Tech</span><span>#AI</span><span>#Gadgets</span>
// // // // // // // // // // // // // // //               </div>
// // // // // // // // // // // // // // //             </div>
// // // // // // // // // // // // // // //             <div className="widget">
// // // // // // // // // // // // // // //               <h3>âœ‰ï¸ Newsletter</h3>
// // // // // // // // // // // // // // //               <input type="email" placeholder="Enter your email" />
// // // // // // // // // // // // // // //               <button>Subscribe</button>
// // // // // // // // // // // // // // //             </div>
// // // // // // // // // // // // // // //           </aside>
// // // // // // // // // // // // // // //         </main>

// // // // // // // // // // // // // // //         {/* Back to top */}
// // // // // // // // // // // // // // //         {showTop && (
// // // // // // // // // // // // // // //           <button className="back-to-top" onClick={() => window.scrollTo({top:0, behavior:"smooth"})}>
// // // // // // // // // // // // // // //             â†‘
// // // // // // // // // // // // // // //           </button>
// // // // // // // // // // // // // // //         )}
// // // // // // // // // // // // // // //       </div>
// // // // // // // // // // // // // // //     </>
// // // // // // // // // // // // // // //   );
// // // // // // // // // // // // // // // };

// // // // // // // // // // // // // // // export default Home;



// // // // // // // // // // // // // // // import React, { useEffect, useState, useRef, useCallback } from "react";
// // // // // // // // // // // // // // // import Seo from "../components/Seo.jsx";
// // // // // // // // // // // // // // // import PostList from "../components/PostList.jsx";
// // // // // // // // // // // // // // // import { Loader, ErrorState } from "../components/Loader.jsx";
// // // // // // // // // // // // // // // import LiveNewsSection from "../components/LiveNewsSection.jsx";
// // // // // // // // // // // // // // // import TrendingPost from "../components/TrendingPost.jsx";
// // // // // // // // // // // // // // // import debounce from "lodash.debounce";
// // // // // // // // // // // // // // // import "./Home.css";

// // // // // // // // // // // // // // // const POSTS_PER_PAGE = 10;

// // // // // // // // // // // // // // // const Home = () => {
// // // // // // // // // // // // // // //   const [categories, setCategories] = useState([{ slug: "all", label: "All", postCount: 0 }]);
// // // // // // // // // // // // // // //   const [popularPosts, setPopularPosts] = useState([]);
// // // // // // // // // // // // // // //   const [selectedCategory, setSelectedCategory] = useState("all");
// // // // // // // // // // // // // // //   const [debouncedTerm, setDebouncedTerm] = useState("");
// // // // // // // // // // // // // // //   const [posts, setPosts] = useState([]);
// // // // // // // // // // // // // // //   const [page, setPage] = useState(1);
// // // // // // // // // // // // // // //   const [hasMore, setHasMore] = useState(true);
// // // // // // // // // // // // // // //   const [loadingPosts, setLoadingPosts] = useState(false);
// // // // // // // // // // // // // // //   const [error, setError] = useState(null);
// // // // // // // // // // // // // // //   const [darkMode, setDarkMode] = useState(false);
// // // // // // // // // // // // // // //   const loadMoreRef = useRef(null);
// // // // // // // // // // // // // // //   const scrollProgressRef = useRef(null);
// // // // // // // // // // // // // // //   const stickyTabsRef = useRef(null);
// // // // // // // // // // // // // // //   const [showTop, setShowTop] = useState(false);

// // // // // // // // // // // // // // //   // Fetch categories dynamically
// // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // //     fetch("http://localhost:4000/api/categories")
// // // // // // // // // // // // // // //       .then(res => res.json())
// // // // // // // // // // // // // // //       .then(data => {
// // // // // // // // // // // // // // //         const cats = data.map(c => ({ slug: c.slug, label: c.name, postCount: c.count || 0 }));
// // // // // // // // // // // // // // //         setCategories([{ slug: "all", label: "All", postCount: cats.reduce((a,b) => a + b.postCount, 0) }, ...cats]);
// // // // // // // // // // // // // // //       });
// // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // //   // Fetch popular posts dynamically (latest 5 posts)
// // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // //     fetch("http://localhost:4000/api/posts?sort=popular&limit=5")
// // // // // // // // // // // // // // //       .then(res => res.json())
// // // // // // // // // // // // // // //       .then(data => setPopularPosts(data.results || data.posts || []))
// // // // // // // // // // // // // // //       .catch(err => console.log("Failed to fetch popular posts:", err));
// // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // //   // Fetch posts
// // // // // // // // // // // // // // //   const fetchPosts = useCallback(() => {
// // // // // // // // // // // // // // //     setLoadingPosts(true);
// // // // // // // // // // // // // // //     setError(null);

// // // // // // // // // // // // // // //     let baseUrl = selectedCategory === "all"
// // // // // // // // // // // // // // //       ? `http://localhost:4000/api/posts`
// // // // // // // // // // // // // // //       : `http://localhost:4000/api/posts?category=${selectedCategory}`;

// // // // // // // // // // // // // // //     const url = new URL(baseUrl);
// // // // // // // // // // // // // // //     if (debouncedTerm.trim()) url.searchParams.set("q", debouncedTerm.trim());
// // // // // // // // // // // // // // //     url.searchParams.set("page", page);
// // // // // // // // // // // // // // //     url.searchParams.set("limit", POSTS_PER_PAGE);

// // // // // // // // // // // // // // //     fetch(url.toString())
// // // // // // // // // // // // // // //       .then(res => { if(!res.ok) throw new Error("Failed to load posts"); return res.json(); })
// // // // // // // // // // // // // // //       .then(data => {
// // // // // // // // // // // // // // //         const newPosts = selectedCategory === "all" ? data.results || [] : data.posts || [];
// // // // // // // // // // // // // // //         setPosts(prev => (page === 1 ? newPosts : [...prev, ...newPosts]));
// // // // // // // // // // // // // // //         setHasMore(newPosts.length === POSTS_PER_PAGE);
// // // // // // // // // // // // // // //         setLoadingPosts(false);
// // // // // // // // // // // // // // //       })
// // // // // // // // // // // // // // //       .catch(e => { setError(e.message); setLoadingPosts(false); });
// // // // // // // // // // // // // // //   }, [page, selectedCategory, debouncedTerm]);

// // // // // // // // // // // // // // //   useEffect(() => { fetchPosts(); }, [fetchPosts]);

// // // // // // // // // // // // // // //   // Infinite scroll
// // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // //     if(!hasMore || loadingPosts) return;
// // // // // // // // // // // // // // //     const observer = new IntersectionObserver(([entry]) => { if(entry.isIntersecting) setPage(p => p+1); }, { rootMargin: "200px" });
// // // // // // // // // // // // // // //     const current = loadMoreRef.current;
// // // // // // // // // // // // // // //     if(current) observer.observe(current);
// // // // // // // // // // // // // // //     return () => current && observer.unobserve(current);
// // // // // // // // // // // // // // //   }, [hasMore, loadingPosts]);

// // // // // // // // // // // // // // //   const handleCategorySelect = slug => {
// // // // // // // // // // // // // // //     setSelectedCategory(slug);
// // // // // // // // // // // // // // //     setPage(1);
// // // // // // // // // // // // // // //     setPosts([]);
// // // // // // // // // // // // // // //   };

// // // // // // // // // // // // // // //   const toggleDarkMode = () => setDarkMode(d => !d);

// // // // // // // // // // // // // // //   // Scroll progress bar
// // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // //     const updateScrollProgress = () => {
// // // // // // // // // // // // // // //       if(!scrollProgressRef.current) return;
// // // // // // // // // // // // // // //       const scrollTop = window.scrollY;
// // // // // // // // // // // // // // //       const docHeight = document.body.scrollHeight - window.innerHeight;
// // // // // // // // // // // // // // //       const progress = Math.min((scrollTop / docHeight) * 100, 100);
// // // // // // // // // // // // // // //       scrollProgressRef.current.style.width = `${progress}%`;
// // // // // // // // // // // // // // //     };
// // // // // // // // // // // // // // //     window.addEventListener("scroll", updateScrollProgress);
// // // // // // // // // // // // // // //     return () => window.removeEventListener("scroll", updateScrollProgress);
// // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // //   // Sticky tabs
// // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // //     const handleScroll = () => { stickyTabsRef.current?.classList.toggle("sticky", window.scrollY > 150); };
// // // // // // // // // // // // // // //     window.addEventListener("scroll", handleScroll);
// // // // // // // // // // // // // // //     return () => window.removeEventListener("scroll", handleScroll);
// // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // //   // Back to top
// // // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // // //     const onScroll = () => setShowTop(window.scrollY > 300);
// // // // // // // // // // // // // // //     window.addEventListener("scroll", onScroll);
// // // // // // // // // // // // // // //     return () => window.removeEventListener("scroll", onScroll);
// // // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // // //   return (
// // // // // // // // // // // // // // //     <>
// // // // // // // // // // // // // // //       <Seo title="Home" description="Explore top articles and latest news" />
// // // // // // // // // // // // // // //       <div className={`home-container ${darkMode ? "dark" : ""}`}>
// // // // // // // // // // // // // // //         <div className="scroll-progress-bar" ref={scrollProgressRef}></div>

// // // // // // // // // // // // // // //         {/* Hero Section */}
// // // // // // // // // // // // // // //         <section className="hero-banner">
// // // // // // // // // // // // // // //           <div className="hero-content">
// // // // // // // // // // // // // // //             <h1>Discover. Learn. Stay Ahead.</h1>
// // // // // // // // // // // // // // //             <p>Your hub for latest articles, tech insights & trending news.</p>
// // // // // // // // // // // // // // //             <div className="hero-buttons">
// // // // // // // // // // // // // // //               <button onClick={() => window.scrollTo({top:600, behavior:"smooth"})}>Explore Posts</button>
// // // // // // // // // // // // // // //               <button onClick={() => window.scrollTo({top:0, behavior:"smooth"})}>Back to Top</button>
// // // // // // // // // // // // // // //             </div>
// // // // // // // // // // // // // // //           </div>
// // // // // // // // // // // // // // //           <button className="dark-mode-toggle" onClick={toggleDarkMode}>
// // // // // // // // // // // // // // //             {darkMode ? "ðŸŒž Light" : "ðŸŒ™ Dark"}
// // // // // // // // // // // // // // //           </button>
// // // // // // // // // // // // // // //         </section>

// // // // // // // // // // // // // // //         {/* Live News & Trending */}
// // // // // // // // // // // // // // //         <LiveNewsSection />
// // // // // // // // // // // // // // //         <TrendingPost />

// // // // // // // // // // // // // // //         {/* Categories */}
// // // // // // // // // // // // // // //         <nav className="category-tabs" ref={stickyTabsRef}>
// // // // // // // // // // // // // // //           {categories.map(c => (
// // // // // // // // // // // // // // //             <button key={c.slug} className={selectedCategory === c.slug ? "active" : ""} onClick={() => handleCategorySelect(c.slug)}>
// // // // // // // // // // // // // // //               {c.label} {c.postCount>0 && <span className="post-count">({c.postCount})</span>}
// // // // // // // // // // // // // // //             </button>
// // // // // // // // // // // // // // //           ))}
// // // // // // // // // // // // // // //         </nav>

// // // // // // // // // // // // // // //         {/* Main Content + Sidebar */}
// // // // // // // // // // // // // // //         <main className="content-layout">
// // // // // // // // // // // // // // //           <section className="main-feed">
// // // // // // // // // // // // // // //             {error && <ErrorState msg={error} />}
// // // // // // // // // // // // // // //             <PostList posts={posts} layout="grid" />
// // // // // // // // // // // // // // //             {!loadingPosts && hasMore && <button className="load-more-btn" onClick={() => setPage(p => p+1)}>Load More</button>}
// // // // // // // // // // // // // // //             {loadingPosts && <Loader />}
// // // // // // // // // // // // // // //             <div ref={loadMoreRef} style={{height:1}} />
// // // // // // // // // // // // // // //           </section>

// // // // // // // // // // // // // // //           <aside className="sidebar">
// // // // // // // // // // // // // // //             {/* Popular Posts */}
// // // // // // // // // // // // // // //             <div className="widget">
// // // // // // // // // // // // // // //               <h3>ðŸ”¥ Popular Posts</h3>
// // // // // // // // // // // // // // //               <ul>
// // // // // // // // // // // // // // //                 {popularPosts.map(post => (
// // // // // // // // // // // // // // //                   <li key={post._id}><a href={`/post/${post.slug}`}>{post.title}</a></li>
// // // // // // // // // // // // // // //                 ))}
// // // // // // // // // // // // // // //               </ul>
// // // // // // // // // // // // // // //             </div>

// // // // // // // // // // // // // // //             {/* Newsletter */}
// // // // // // // // // // // // // // //             <div className="widget newsletter-box">
// // // // // // // // // // // // // // //               <h3>âœ‰ï¸ Subscribe</h3>
// // // // // // // // // // // // // // //               <input type="email" placeholder="Enter your email" />
// // // // // // // // // // // // // // //               <button>Subscribe</button>
// // // // // // // // // // // // // // //             </div>

// // // // // // // // // // // // // // //             {/* Categories Quick Links */}
// // // // // // // // // // // // // // //             <div className="widget">
// // // // // // // // // // // // // // //               <h3>ðŸ“‚ Categories</h3>
// // // // // // // // // // // // // // //               <div className="category-chips">
// // // // // // // // // // // // // // //                 {categories.slice(1).map(c => (
// // // // // // // // // // // // // // //                   <button key={c.slug} onClick={() => handleCategorySelect(c.slug)}>{c.label}</button>
// // // // // // // // // // // // // // //                 ))}
// // // // // // // // // // // // // // //               </div>
// // // // // // // // // // // // // // //             </div>
// // // // // // // // // // // // // // //           </aside>
// // // // // // // // // // // // // // //         </main>

// // // // // // // // // // // // // // //         {/* Back to top */}
// // // // // // // // // // // // // // //         {showTop && <button className="back-to-top" onClick={() => window.scrollTo({top:0, behavior:"smooth"})}>â†‘</button>}
// // // // // // // // // // // // // // //       </div>
// // // // // // // // // // // // // // //     </>
// // // // // // // // // // // // // // //   );
// // // // // // // // // // // // // // // };

// // // // // // // // // // // // // // // export default Home;


// // // // // // // // // // // // // // import React, { useEffect, useState, useRef, useCallback } from "react";
// // // // // // // // // // // // // // import Seo from "../components/Seo.jsx";
// // // // // // // // // // // // // // import PostList from "../components/PostList.jsx";
// // // // // // // // // // // // // // import { Loader, ErrorState } from "../components/Loader.jsx";
// // // // // // // // // // // // // // import TrendingPost from "../components/TrendingPost.jsx";
// // // // // // // // // // // // // // import debounce from "lodash.debounce";
// // // // // // // // // // // // // // import "./Home.css";

// // // // // // // // // // // // // // const POSTS_PER_PAGE = 10;

// // // // // // // // // // // // // // const Home = () => {
// // // // // // // // // // // // // //   const [posts, setPosts] = useState([]);
// // // // // // // // // // // // // //   const [page, setPage] = useState(1);
// // // // // // // // // // // // // //   const [hasMore, setHasMore] = useState(true);
// // // // // // // // // // // // // //   const [loadingPosts, setLoadingPosts] = useState(false);
// // // // // // // // // // // // // //   const [error, setError] = useState(null);
// // // // // // // // // // // // // //   const [darkMode, setDarkMode] = useState(false);
// // // // // // // // // // // // // //   const loadMoreRef = useRef(null);
// // // // // // // // // // // // // //   const scrollProgressRef = useRef(null);
// // // // // // // // // // // // // //   const [showTop, setShowTop] = useState(false);

// // // // // // // // // // // // // //   // Live news state for carousel
// // // // // // // // // // // // // //   const [liveNews, setLiveNews] = useState([]);
// // // // // // // // // // // // // //   const [newsStartIndex, setNewsStartIndex] = useState(0);
// // // // // // // // // // // // // //   const NEWS_DISPLAY_COUNT = 3;

// // // // // // // // // // // // // //   // Fetch posts
// // // // // // // // // // // // // //   const fetchPosts = useCallback(() => {
// // // // // // // // // // // // // //     setLoadingPosts(true);
// // // // // // // // // // // // // //     setError(null);
// // // // // // // // // // // // // //     const url = new URL("http://localhost:4000/api/posts");
// // // // // // // // // // // // // //     url.searchParams.set("page", page);
// // // // // // // // // // // // // //     url.searchParams.set("limit", POSTS_PER_PAGE);

// // // // // // // // // // // // // //     fetch(url.toString())
// // // // // // // // // // // // // //       .then(res => { if (!res.ok) throw new Error("Failed to load posts"); return res.json(); })
// // // // // // // // // // // // // //       .then(data => {
// // // // // // // // // // // // // //         const newPosts = data.results || [];
// // // // // // // // // // // // // //         setPosts(prev => (page === 1 ? newPosts : [...prev, ...newPosts]));
// // // // // // // // // // // // // //         setHasMore(newPosts.length === POSTS_PER_PAGE);
// // // // // // // // // // // // // //         setLoadingPosts(false);
// // // // // // // // // // // // // //       })
// // // // // // // // // // // // // //       .catch(e => { setError(e.message); setLoadingPosts(false); });
// // // // // // // // // // // // // //   }, [page]);

// // // // // // // // // // // // // //   useEffect(() => { fetchPosts(); }, [fetchPosts]);

// // // // // // // // // // // // // //   // Infinite scroll
// // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // //     if (!hasMore || loadingPosts) return;
// // // // // // // // // // // // // //     const observer = new IntersectionObserver(([entry]) => { if (entry.isIntersecting) setPage(p => p + 1); }, { rootMargin: "200px" });
// // // // // // // // // // // // // //     const current = loadMoreRef.current;
// // // // // // // // // // // // // //     if (current) observer.observe(current);
// // // // // // // // // // // // // //     return () => current && observer.unobserve(current);
// // // // // // // // // // // // // //   }, [hasMore, loadingPosts]);

// // // // // // // // // // // // // //   // Dark mode toggle
// // // // // // // // // // // // // //   const toggleDarkMode = () => setDarkMode(d => !d);

// // // // // // // // // // // // // //   // Scroll progress bar
// // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // //     const updateScrollProgress = () => {
// // // // // // // // // // // // // //       if (!scrollProgressRef.current) return;
// // // // // // // // // // // // // //       const scrollTop = window.scrollY;
// // // // // // // // // // // // // //       const docHeight = document.body.scrollHeight - window.innerHeight;
// // // // // // // // // // // // // //       const progress = Math.min((scrollTop / docHeight) * 100, 100);
// // // // // // // // // // // // // //       scrollProgressRef.current.style.width = `${progress}%`;
// // // // // // // // // // // // // //     };
// // // // // // // // // // // // // //     window.addEventListener("scroll", updateScrollProgress);
// // // // // // // // // // // // // //     return () => window.removeEventListener("scroll", updateScrollProgress);
// // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // //   // Back to top button
// // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // //     const onScroll = () => setShowTop(window.scrollY > 300);
// // // // // // // // // // // // // //     window.addEventListener("scroll", onScroll);
// // // // // // // // // // // // // //     return () => window.removeEventListener("scroll", onScroll);
// // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // //   // Fetch live news for sidebar carousel
// // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // //     fetch("http://localhost:4000/api/posts?limit=10") // Fetch latest 10 posts
// // // // // // // // // // // // // //       .then(res => res.json())
// // // // // // // // // // // // // //       .then(data => setLiveNews(data.results || []))
// // // // // // // // // // // // // //       .catch(err => console.error("Live news fetch failed:", err));
// // // // // // // // // // // // // //   }, []);

// // // // // // // // // // // // // //   const handleNextNews = () => {
// // // // // // // // // // // // // //     setNewsStartIndex(prev => (prev + 1) % liveNews.length);
// // // // // // // // // // // // // //   };
// // // // // // // // // // // // // //   const handlePrevNews = () => {
// // // // // // // // // // // // // //     setNewsStartIndex(prev => (prev - 1 + liveNews.length) % liveNews.length);
// // // // // // // // // // // // // //   };

// // // // // // // // // // // // // //   const displayedNews = liveNews.slice(newsStartIndex, newsStartIndex + NEWS_DISPLAY_COUNT);

// // // // // // // // // // // // // //   return (
// // // // // // // // // // // // // //     <>
// // // // // // // // // // // // // //       <Seo title="Home" description="Explore top articles and latest news" />
// // // // // // // // // // // // // //       <div className={`home-container ${darkMode ? "dark" : ""}`}>
// // // // // // // // // // // // // //         <div className="scroll-progress-bar" ref={scrollProgressRef}></div>

// // // // // // // // // // // // // //         {/* Hero Section */}
// // // // // // // // // // // // // //         <section className="hero-banner">
// // // // // // // // // // // // // //           <div className="hero-content">
// // // // // // // // // // // // // //             <h1>Discover. Learn. Stay Ahead.</h1>
// // // // // // // // // // // // // //             <p>Your one-stop hub for latest articles, tech insights & trending news.</p>
// // // // // // // // // // // // // //           </div>
// // // // // // // // // // // // // //           <button className="dark-mode-toggle" onClick={toggleDarkMode}>
// // // // // // // // // // // // // //             {darkMode ? "ðŸŒž Light" : "ðŸŒ™ Dark"}
// // // // // // // // // // // // // //           </button>
// // // // // // // // // // // // // //         </section>

// // // // // // // // // // // // // //         {/* Trending Post */}
// // // // // // // // // // // // // //         <TrendingPost />

// // // // // // // // // // // // // //         {/* Main Content + Sidebar */}
// // // // // // // // // // // // // //         <main className="content-layout">
// // // // // // // // // // // // // //           <section className="main-feed">
// // // // // // // // // // // // // //             {error && <ErrorState msg={error} />}
// // // // // // // // // // // // // //             <PostList posts={posts} layout="grid" />
// // // // // // // // // // // // // //             {!loadingPosts && hasMore && (
// // // // // // // // // // // // // //               <button className="load-more-btn" onClick={() => setPage(p => p + 1)}>Load More</button>
// // // // // // // // // // // // // //             )}
// // // // // // // // // // // // // //             {loadingPosts && <Loader />}
// // // // // // // // // // // // // //             <div ref={loadMoreRef} style={{ height: 1 }} />
// // // // // // // // // // // // // //           </section>

// // // // // // // // // // // // // //           <aside className="sidebar">
// // // // // // // // // // // // // //             {/* Live News Carousel */}
// // // // // // // // // // // // // //             <div className="widget live-news-widget">
// // // // // // // // // // // // // //               <h3>ðŸ“° Latest News</h3>
// // // // // // // // // // // // // //               <div className="news-carousel">
// // // // // // // // // // // // // //                 {displayedNews.map((news, idx) => (
// // // // // // // // // // // // // //                   <div key={news._id} className="news-item">
// // // // // // // // // // // // // //                     <a href={`/post/${news.slug}`}>{news.title}</a>
// // // // // // // // // // // // // //                   </div>
// // // // // // // // // // // // // //                 ))}
// // // // // // // // // // // // // //               </div>
// // // // // // // // // // // // // //               <div className="carousel-controls">
// // // // // // // // // // // // // //                 <button onClick={handlePrevNews}>â¬†</button>
// // // // // // // // // // // // // //                 <button onClick={handleNextNews}>â¬‡</button>
// // // // // // // // // // // // // //               </div>
// // // // // // // // // // // // // //             </div>

// // // // // // // // // // // // // //             {/* Popular Tags Widget */}
// // // // // // // // // // // // // //             <div className="widget">
// // // // // // // // // // // // // //               <h3>ðŸ“Œ Popular Tags</h3>
// // // // // // // // // // // // // //               <div className="tags">
// // // // // // // // // // // // // //                 <span>#Tech</span>
// // // // // // // // // // // // // //                 <span>#AI</span>
// // // // // // // // // // // // // //                 <span>#Gadgets</span>
// // // // // // // // // // // // // //               </div>
// // // // // // // // // // // // // //             </div>

// // // // // // // // // // // // // //             {/* Newsletter Widget */}
// // // // // // // // // // // // // //             <div className="widget newsletter-box">
// // // // // // // // // // // // // //               <h3>âœ‰ï¸ Newsletter</h3>
// // // // // // // // // // // // // //               <input type="email" placeholder="Enter your email" />
// // // // // // // // // // // // // //               <button>Subscribe</button>
// // // // // // // // // // // // // //             </div>
// // // // // // // // // // // // // //           </aside>
// // // // // // // // // // // // // //         </main>

// // // // // // // // // // // // // //         {/* Back to top */}
// // // // // // // // // // // // // //         {showTop && (
// // // // // // // // // // // // // //           <button className="back-to-top" onClick={() => window.scrollTo({ top: 0, behavior: "smooth" })}>
// // // // // // // // // // // // // //             â†‘
// // // // // // // // // // // // // //           </button>
// // // // // // // // // // // // // //         )}
// // // // // // // // // // // // // //       </div>
// // // // // // // // // // // // // //     </>
// // // // // // // // // // // // // //   );
// // // // // // // // // // // // // // };

// // // // // // // // // // // // // // export default Home;




// // // // // // // // // // // // import React, { useEffect, useState, useRef, useCallback } from "react";
// // // // // // // // // // // // import Seo from "../components/Seo.jsx";
// // // // // // // // // // // // import PostList from "../components/PostList.jsx";
// // // // // // // // // // // // import { Loader, ErrorState } from "../components/Loader.jsx";
// // // // // // // // // // // // import TrendingPost from "../components/TrendingPost.jsx";
// // // // // // // // // // // // import "./Home.css";

// // // // // // // // // // // // const POSTS_PER_PAGE = 10;

// // // // // // // // // // // // const Home = () => {
// // // // // // // // // // // //   const [posts, setPosts] = useState([]);
// // // // // // // // // // // //   const [page, setPage] = useState(1);
// // // // // // // // // // // //   const [hasMore, setHasMore] = useState(true);
// // // // // // // // // // // //   const [loadingPosts, setLoadingPosts] = useState(false);
// // // // // // // // // // // //   const [error, setError] = useState(null);
// // // // // // // // // // // //   const [darkMode, setDarkMode] = useState(false);
// // // // // // // // // // // //   const loadMoreRef = useRef(null);
// // // // // // // // // // // //   const scrollProgressRef = useRef(null);
// // // // // // // // // // // //   const [showTop, setShowTop] = useState(false);

// // // // // // // // // // // //   // Live news state for carousel
// // // // // // // // // // // //   const [liveNews, setLiveNews] = useState([]);
// // // // // // // // // // // //   const [newsStartIndex, setNewsStartIndex] = useState(0);
// // // // // // // // // // // //   const NEWS_DISPLAY_COUNT = 3;

// // // // // // // // // // // //   // Fetch posts
// // // // // // // // // // // //   const fetchPosts = useCallback(() => {
// // // // // // // // // // // //     setLoadingPosts(true);
// // // // // // // // // // // //     setError(null);
// // // // // // // // // // // //     const url = new URL("http://localhost:4000/api/posts");
// // // // // // // // // // // //     url.searchParams.set("page", page);
// // // // // // // // // // // //     url.searchParams.set("limit", POSTS_PER_PAGE);

// // // // // // // // // // // //     fetch(url.toString())
// // // // // // // // // // // //       .then(res => { if (!res.ok) throw new Error("Failed to load posts"); return res.json(); })
// // // // // // // // // // // //       .then(data => {
// // // // // // // // // // // //         const newPosts = data.results || [];
// // // // // // // // // // // //         setPosts(prev => (page === 1 ? newPosts : [...prev, ...newPosts]));
// // // // // // // // // // // //         setHasMore(newPosts.length === POSTS_PER_PAGE);
// // // // // // // // // // // //         setLoadingPosts(false);
// // // // // // // // // // // //       })
// // // // // // // // // // // //       .catch(e => { setError(e.message); setLoadingPosts(false); });
// // // // // // // // // // // //   }, [page]);

// // // // // // // // // // // //   useEffect(() => { fetchPosts(); }, [fetchPosts]);

// // // // // // // // // // // //   // Infinite scroll
// // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // //     if (!hasMore || loadingPosts) return;
// // // // // // // // // // // //     const observer = new IntersectionObserver(([entry]) => { if (entry.isIntersecting) setPage(p => p + 1); }, { rootMargin: "200px" });
// // // // // // // // // // // //     const current = loadMoreRef.current;
// // // // // // // // // // // //     if (current) observer.observe(current);
// // // // // // // // // // // //     return () => current && observer.unobserve(current);
// // // // // // // // // // // //   }, [hasMore, loadingPosts]);

// // // // // // // // // // // //   // Dark mode toggle
// // // // // // // // // // // //   const toggleDarkMode = () => setDarkMode(d => !d);

// // // // // // // // // // // //   // Scroll progress bar
// // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // //     const updateScrollProgress = () => {
// // // // // // // // // // // //       if (!scrollProgressRef.current) return;
// // // // // // // // // // // //       const scrollTop = window.scrollY;
// // // // // // // // // // // //       const docHeight = document.body.scrollHeight - window.innerHeight;
// // // // // // // // // // // //       const progress = Math.min((scrollTop / docHeight) * 100, 100);
// // // // // // // // // // // //       scrollProgressRef.current.style.width = `${progress}%`;
// // // // // // // // // // // //     };
// // // // // // // // // // // //     window.addEventListener("scroll", updateScrollProgress);
// // // // // // // // // // // //     return () => window.removeEventListener("scroll", updateScrollProgress);
// // // // // // // // // // // //   }, []);

// // // // // // // // // // // //   // Back to top button
// // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // //     const onScroll = () => setShowTop(window.scrollY > 300);
// // // // // // // // // // // //     window.addEventListener("scroll", onScroll);
// // // // // // // // // // // //     return () => window.removeEventListener("scroll", onScroll);
// // // // // // // // // // // //   }, []);

// // // // // // // // // // // //   // Fetch live news for sidebar carousel
// // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // //     fetch("http://localhost:4000/api/posts?limit=10") // Fetch latest 10 posts
// // // // // // // // // // // //       .then(res => res.json())
// // // // // // // // // // // //       .then(data => setLiveNews(data.results || []))
// // // // // // // // // // // //       .catch(err => console.error("Live news fetch failed:", err));
// // // // // // // // // // // //   }, []);

// // // // // // // // // // // //   const handleNextNews = () => {
// // // // // // // // // // // //     setNewsStartIndex(prev => (prev + 1) % liveNews.length);
// // // // // // // // // // // //   };
// // // // // // // // // // // //   const handlePrevNews = () => {
// // // // // // // // // // // //     setNewsStartIndex(prev => (prev - 1 + liveNews.length) % liveNews.length);
// // // // // // // // // // // //   };

// // // // // // // // // // // //   const displayedNews = liveNews.slice(newsStartIndex, newsStartIndex + NEWS_DISPLAY_COUNT);

// // // // // // // // // // // //   return (
// // // // // // // // // // // //     <>
// // // // // // // // // // // //       <Seo title="Home" description="Explore top articles and latest news" />
// // // // // // // // // // // //       <div className={`home-container ${darkMode ? "dark" : ""}`}>
// // // // // // // // // // // //         <div className="scroll-progress-bar" ref={scrollProgressRef}></div>

        
// // // // // // // // // // // //         {/* <section className="hero-banner">
// // // // // // // // // // // //           <div className="hero-content">
// // // // // // // // // // // //             <h1>Discover. Learn. Stay Ahead.</h1>
// // // // // // // // // // // //             <p>Your one-stop hub for latest articles, tech insights & trending news.</p>
// // // // // // // // // // // //           </div>
// // // // // // // // // // // //           <button className="dark-mode-toggle" onClick={toggleDarkMode}>
// // // // // // // // // // // //             {darkMode ? "ðŸŒž Light" : "ðŸŒ™ Dark"}
// // // // // // // // // // // //           </button>
// // // // // // // // // // // //         </section> */}
// // // // // // // // // // // //           {/* Hero Section */}
// // // // // // // // // // // //         {/* <section className="hero-section">
// // // // // // // // // // // //           <div className="hero-overlay" />
// // // // // // // // // // // //           <div className="hero-content">
// // // // // // // // // // // //             <h1>Stay Updated. Stay Ahead.</h1>
// // // // // // // // // // // //             <p>Explore the latest articles, tech trends, and insights in one place.</p>
// // // // // // // // // // // //             <a href="#main-feed" className="cta-button">Explore Articles</a>
// // // // // // // // // // // //           </div>
// // // // // // // // // // // //           <button className="dark-mode-toggle" onClick={toggleDarkMode}>
// // // // // // // // // // // //             {darkMode ? "ðŸŒž Light" : "ðŸŒ™ Dark"}
// // // // // // // // // // // //           </button>
// // // // // // // // // // // //         </section> */}

// // // // // // // // // // // //         <section className="hero-section">
// // // // // // // // // // // //   <div className="hero-overlay" />
// // // // // // // // // // // //   <div className="hero-content">
// // // // // // // // // // // //     <h1 className="hero-title">Stay Updated. Stay Ahead.</h1>
// // // // // // // // // // // //     <p className="hero-subtitle">Explore the latest articles, tech trends, and insights in one place.</p>
// // // // // // // // // // // //     <a href="#main-feed" className="cta-button">Explore Articles</a>
// // // // // // // // // // // //   </div>
// // // // // // // // // // // //   <button className="dark-mode-toggle" onClick={toggleDarkMode}>
// // // // // // // // // // // //     {darkMode ? "ðŸŒž Light" : "ðŸŒ™ Dark"}
// // // // // // // // // // // //   </button>
// // // // // // // // // // // // </section>


// // // // // // // // // // // //         {/* Trending Post */}
// // // // // // // // // // // //         <TrendingPost big={true} /> {/* big=true for larger prominent card */}

// // // // // // // // // // // //         {/* Main Content + Sidebar */}
// // // // // // // // // // // //         <main className="content-layout">
// // // // // // // // // // // //           <section className="main-feed">
// // // // // // // // // // // //             {error && <ErrorState msg={error} />}
// // // // // // // // // // // //             <PostList posts={posts} layout="grid" />
// // // // // // // // // // // //             {!loadingPosts && hasMore &&
// // // // // // // // // // // //               <button className="load-more-btn" onClick={() => setPage(p => p + 1)}>Load More</button>
// // // // // // // // // // // //             }
// // // // // // // // // // // //             {loadingPosts && <Loader />}
// // // // // // // // // // // //             <div ref={loadMoreRef} style={{ height: 1 }} />
// // // // // // // // // // // //           </section>

// // // // // // // // // // // //          <aside className="sidebar">
// // // // // // // // // // // //   {/* Live News Carousel */}
// // // // // // // // // // // //   <div className="widget live-news-widget">
// // // // // // // // // // // //     <h3>ðŸ“° Latest News</h3>
// // // // // // // // // // // //     <div className="news-carousel">
// // // // // // // // // // // //       {displayedNews.map(news => (
// // // // // // // // // // // //         <div key={news._id} className="news-item">
// // // // // // // // // // // //           <a href={`/post/${news.slug}`}>{news.title}</a>
// // // // // // // // // // // //         </div>
// // // // // // // // // // // //       ))}
// // // // // // // // // // // //     </div>
// // // // // // // // // // // //     <div className="carousel-controls">
// // // // // // // // // // // //       <button onClick={handlePrevNews}>â¬†</button>
// // // // // // // // // // // //       <button onClick={handleNextNews}>â¬‡</button>
// // // // // // // // // // // //     </div>
// // // // // // // // // // // //   </div>

// // // // // // // // // // // //   {/* Popular Tags Widget */}
// // // // // // // // // // // //   <div className="widget">
// // // // // // // // // // // //     <h3>ðŸ“Œ Popular Tags</h3>
// // // // // // // // // // // //     <div className="tags">
// // // // // // // // // // // //       <span>#Tech</span>
// // // // // // // // // // // //       <span>#AI</span>
// // // // // // // // // // // //       <span>#Gadgets</span>
// // // // // // // // // // // //       <span>#Programming</span>
// // // // // // // // // // // //       <span>#WebDev</span>
// // // // // // // // // // // //     </div>
// // // // // // // // // // // //   </div>

// // // // // // // // // // // //   {/* Newsletter Widget */}
// // // // // // // // // // // //   <div className="widget newsletter-box">
// // // // // // // // // // // //     <h3>âœ‰ï¸ Newsletter</h3>
// // // // // // // // // // // //     <input type="email" placeholder="Enter your email" />
// // // // // // // // // // // //     <button>Subscribe</button>
// // // // // // // // // // // //   </div>

// // // // // // // // // // // //   {/* Trending Authors Widget */}
// // // // // // // // // // // //   <div className="widget trending-authors">
// // // // // // // // // // // //     <h3>ðŸ”¥ Top Authors</h3>
// // // // // // // // // // // //     <ul>
// // // // // // // // // // // //       <li><a href="#">ðŸ‘¤ Alice Johnson</a></li>
// // // // // // // // // // // //       <li><a href="#">ðŸ‘¤ Bob Smith</a></li>
// // // // // // // // // // // //       <li><a href="#">ðŸ‘¤ Clara Lee</a></li>
// // // // // // // // // // // //       <li><a href="#">ðŸ‘¤ David Kim</a></li>
// // // // // // // // // // // //     </ul>
// // // // // // // // // // // //   </div>

// // // // // // // // // // // //   {/* Popular Categories Widget */}
// // // // // // // // // // // //   <div className="widget popular-categories">
// // // // // // // // // // // //     <h3>ðŸ—‚ Popular Categories</h3>
// // // // // // // // // // // //     <ul>
// // // // // // // // // // // //       <li><a href="#">Technology</a></li>
// // // // // // // // // // // //       <li><a href="#">AI & ML</a></li>
// // // // // // // // // // // //       <li><a href="#">Health</a></li>
// // // // // // // // // // // //       <li><a href="#">Finance</a></li>
// // // // // // // // // // // //     </ul>
// // // // // // // // // // // //   </div>

// // // // // // // // // // // //  {/* 8. Quick Poll */}
// // // // // // // // // // // //   <div className="widget">
// // // // // // // // // // // //     <h3>ðŸ“Š Poll: Favorite Tech?</h3>
// // // // // // // // // // // //     <div className="poll">
// // // // // // // // // // // //       <label><input type="radio" name="tech" /> AI</label>
// // // // // // // // // // // //       <label><input type="radio" name="tech" /> Blockchain</label>
// // // // // // // // // // // //       <label><input type="radio" name="tech" /> Web3</label>
// // // // // // // // // // // //       <button>Vote</button>
// // // // // // // // // // // //     </div>
// // // // // // // // // // // //   </div>

// // // // // // // // // // // //   {/* 9. Quote of the Day */}
// // // // // // // // // // // //   <div className="widget quote-widget">
// // // // // // // // // // // //     <h3>ðŸ’¡ Quote of the Day</h3>
// // // // // // // // // // // //     <p>"The best way to predict the future is to invent it." â€“ Alan Kay</p>
// // // // // // // // // // // //   </div>

// // // // // // // // // // // // {/* 10. Most Read Articles */}
// // // // // // // // // // // // <div className="widget">
// // // // // // // // // // // //   <h3>ðŸ“ˆ Most Read</h3>
// // // // // // // // // // // //   <ul>
// // // // // // // // // // // //     <li><a href="#">How AI is Changing Tech</a></li>
// // // // // // // // // // // //     <li><a href="#">Top 10 Programming Languages 2025</a></li>
// // // // // // // // // // // //     <li><a href="#">Guide to Web3 for Beginners</a></li>
// // // // // // // // // // // //   </ul>
// // // // // // // // // // // // </div>

// // // // // // // // // // // // {/* 11. Upcoming Events */}
// // // // // // // // // // // // <div className="widget">
// // // // // // // // // // // //   <h3>ðŸ“… Upcoming Events</h3>
// // // // // // // // // // // //   <ul>
// // // // // // // // // // // //     <li>Webinar: AI in Daily Life - Oct 10</li>
// // // // // // // // // // // //     <li>Workshop: React Basics - Oct 15</li>
// // // // // // // // // // // //   </ul>
// // // // // // // // // // // // </div>

// // // // // // // // // // // // {/* 12. Tech Tip of the Day */}
// // // // // // // // // // // // <div className="widget">
// // // // // // // // // // // //   <h3>ðŸ’¡ Tech Tip</h3>
// // // // // // // // // // // //   <p>Use keyboard shortcuts to boost your productivity. Ctrl + Shift + T reopens closed tabs!</p>
// // // // // // // // // // // // </div>

// // // // // // // // // // // // {/* 13. Video Spotlight */}
// // // // // // // // // // // // <div className="widget">
// // // // // // // // // // // //   <h3>ðŸŽ¥ Video Spotlight</h3>
// // // // // // // // // // // //   <iframe width="100%" height="150" src="https://www.youtube.com/embed/dQw4w9WgXcQ" title="Video"></iframe>
// // // // // // // // // // // // </div>

// // // // // // // // // // // // {/* 14. Poll Results */}
// // // // // // // // // // // // <div className="widget">
// // // // // // // // // // // //   <h3>ðŸ“Š Poll Results</h3>
// // // // // // // // // // // //   <p>AI: 45% | Blockchain: 30% | Web3: 25%</p>
// // // // // // // // // // // // </div>


// // // // // // // // // // // //   {/* Social Media Follow Widget */}
// // // // // // // // // // // //   <div className="widget social-follow">
// // // // // // // // // // // //     <h3>ðŸ”— Follow Us</h3>
// // // // // // // // // // // //     <div className="social-icons">
// // // // // // // // // // // //       <a href="#" className="facebook">FB</a>
// // // // // // // // // // // //       <a href="#" className="twitter">TW</a>
// // // // // // // // // // // //       <a href="#" className="instagram">IG</a>
// // // // // // // // // // // //       <a href="#" className="linkedin">IN</a>
// // // // // // // // // // // //     </div>
// // // // // // // // // // // //   </div>
// // // // // // // // // // // // </aside>

// // // // // // // // // // // //         </main>

// // // // // // // // // // // //         {/* Back to top */}
// // // // // // // // // // // //         {showTop &&
// // // // // // // // // // // //           <button className="back-to-top" onClick={() => window.scrollTo({ top: 0, behavior: "smooth" })}>â†‘</button>
// // // // // // // // // // // //         }
// // // // // // // // // // // //       </div>
// // // // // // // // // // // //     </>
// // // // // // // // // // // //   );
// // // // // // // // // // // // };

// // // // // // // // // // // // export default Home;




// // // // // // // // // // // // Home.jsx
// // // // // // // // // import React, { useEffect, useState, useRef, useCallback } from "react";
// // // // // // // // // import Seo from "../components/Seo.jsx";
// // // // // // // // // import PostList from "../components/PostList.jsx";
// // // // // // // // // import { Loader, ErrorState } from "../components/Loader.jsx";
// // // // // // // // // import TrendingPost from "../components/TrendingPost.jsx";
// // // // // // // // // import "./Home.css";

// // // // // // // // // import { Link } from "react-router-dom";

// // // // // // // // // const POSTS_PER_PAGE = 10;

// // // // // // // // // const Home = () => {
// // // // // // // // //   const [posts, setPosts] = useState([]);
// // // // // // // // //   const [page, setPage] = useState(1);
// // // // // // // // //   const [hasMore, setHasMore] = useState(true);
// // // // // // // // //   const [loadingPosts, setLoadingPosts] = useState(false);
// // // // // // // // //   const [error, setError] = useState(null);
// // // // // // // // //   const loadMoreRef = useRef(null);
// // // // // // // // //   const scrollProgressRef = useRef(null);
// // // // // // // // //   const [showTop, setShowTop] = useState(false);

// // // // // // // // //   const [trendingPosts, setTrendingPosts] = useState([]);
// // // // // // // // //   const [carouselIndex, setCarouselIndex] = useState(0);
// // // // // // // // //   const CAROUSEL_DISPLAY = 4;

// // // // // // // // //   // Fetch main posts
// // // // // // // // //   const fetchPosts = useCallback(() => {
// // // // // // // // //     setLoadingPosts(true);
// // // // // // // // //     setError(null);
// // // // // // // // //     const url = new URL("http://localhost:4000/api/posts");
// // // // // // // // //     url.searchParams.set("page", page);
// // // // // // // // //     url.searchParams.set("limit", POSTS_PER_PAGE);

// // // // // // // // //     fetch(url.toString())
// // // // // // // // //       .then(res => { if (!res.ok) throw new Error("Failed to load posts"); return res.json(); })
// // // // // // // // //       .then(data => {
// // // // // // // // //         const newPosts = data.results || [];
// // // // // // // // //         setPosts(prev => (page === 1 ? newPosts : [...prev, ...newPosts]));
// // // // // // // // //         setHasMore(newPosts.length === POSTS_PER_PAGE);
// // // // // // // // //         setLoadingPosts(false);
// // // // // // // // //       })
// // // // // // // // //       .catch(e => { setError(e.message); setLoadingPosts(false); });
// // // // // // // // //   }, [page]);

// // // // // // // // //   useEffect(() => { fetchPosts(); }, [fetchPosts]);

// // // // // // // // //   // Infinite scroll
// // // // // // // // //   useEffect(() => {
// // // // // // // // //     if (!hasMore || loadingPosts) return;
// // // // // // // // //     const observer = new IntersectionObserver(([entry]) => { if (entry.isIntersecting) setPage(p => p + 1); }, { rootMargin: "200px" });
// // // // // // // // //     const current = loadMoreRef.current;
// // // // // // // // //     if (current) observer.observe(current);
// // // // // // // // //     return () => current && observer.unobserve(current);
// // // // // // // // //   }, [hasMore, loadingPosts]);

// // // // // // // // //   // Scroll progress bar
// // // // // // // // //   useEffect(() => {
// // // // // // // // //     const updateScrollProgress = () => {
// // // // // // // // //       if (!scrollProgressRef.current) return;
// // // // // // // // //       const scrollTop = window.scrollY;
// // // // // // // // //       const docHeight = document.body.scrollHeight - window.innerHeight;
// // // // // // // // //       const progress = Math.min((scrollTop / docHeight) * 100, 100);
// // // // // // // // //       scrollProgressRef.current.style.width = `${progress}%`;
// // // // // // // // //     };
// // // // // // // // //     window.addEventListener("scroll", updateScrollProgress);
// // // // // // // // //     return () => window.removeEventListener("scroll", updateScrollProgress);
// // // // // // // // //   }, []);

// // // // // // // // //   // Back to top button
// // // // // // // // //   useEffect(() => {
// // // // // // // // //     const onScroll = () => setShowTop(window.scrollY > 300);
// // // // // // // // //     window.addEventListener("scroll", onScroll);
// // // // // // // // //     return () => window.removeEventListener("scroll", onScroll);
// // // // // // // // //   }, []);

// // // // // // // // //   // Fetch trending posts
// // // // // // // // //   useEffect(() => {
// // // // // // // // //     fetch("http://localhost:4000/api/posts?limit=10")
// // // // // // // // //       .then(res => res.json())
// // // // // // // // //       .then(data => setTrendingPosts(data.results || []))
// // // // // // // // //       .catch(err => console.error("Trending posts fetch failed:", err));
// // // // // // // // //   }, []);

// // // // // // // // //   const handleNextCarousel = () => {
// // // // // // // // //     setCarouselIndex(prev => (prev + 1) % trendingPosts.length);
// // // // // // // // //   };
// // // // // // // // //   const handlePrevCarousel = () => {
// // // // // // // // //     setCarouselIndex(prev => (prev - 1 + trendingPosts.length) % trendingPosts.length);
// // // // // // // // //   };
// // // // // // // // //   const displayedCarousel = trendingPosts.slice(carouselIndex, carouselIndex + CAROUSEL_DISPLAY);

// // // // // // // // //   return (
// // // // // // // // //     <>
// // // // // // // // //       <Seo title="Home" description="Explore top articles and latest news" />
// // // // // // // // //       <div className="home-container">
// // // // // // // // //         <div className="scroll-progress-bar" ref={scrollProgressRef}></div>

// // // // // // // // //         {/* Featured Trending Post */}
// // // // // // // // //         {trendingPosts[0] && <TrendingPost big={true} post={trendingPosts[0]} />}

// // // // // // // // //         {/* Trending Carousel */}
// // // // // // // // //         <section className="trending-carousel">
// // // // // // // // //           <h3>Trending Posts</h3>
// // // // // // // // //           <div className="carousel-wrapper">
// // // // // // // // //             <button onClick={handlePrevCarousel} className="carousel-btn">â¬…</button>
// // // // // // // // //             <div className="carousel-items">
// // // // // // // // //               {displayedCarousel.map(post => (
// // // // // // // // //                 <TrendingPost key={post._id} big={false} post={post} />
// // // // // // // // //               ))}
// // // // // // // // //             </div>
// // // // // // // // //             <button onClick={handleNextCarousel} className="carousel-btn">âž¡</button>
// // // // // // // // //           </div>
// // // // // // // // //         </section>

// // // // // // // // //         {/* Main Feed */}
// // // // // // // // //         <main className="content-layout">
// // // // // // // // //           <section className="main-feed">
// // // // // // // // //             {error && <ErrorState msg={error} />}
// // // // // // // // //             <PostList posts={posts} layout="grid-2col" />
// // // // // // // // //             {!loadingPosts && hasMore && 
// // // // // // // // //               <button className="load-more-btn" onClick={() => setPage(p => p + 1)}>Load More</button>
// // // // // // // // //             }
// // // // // // // // //             {loadingPosts && <Loader />}
// // // // // // // // //             <div ref={loadMoreRef} style={{ height: 1 }} />
// // // // // // // // //           </section>

// // // // // // // // //           {/* Sidebar */}
// // // // // // // // //           <aside className="sidebar">
// // // // // // // // //            {/* Search Box */}
// // // // // // // // //   <div className="sidebar-widget search-widget">
// // // // // // // // //     <input type="text" placeholder="Search articles..." />
// // // // // // // // //     <button>ðŸ”</button>
// // // // // // // // //   </div>

// // // // // // // // //   {/* Trending Tags */}
// // // // // // // // //   <div className="sidebar-widget tags-widget">
// // // // // // // // //     <h4>Trending Tags</h4>
// // // // // // // // //     <div className="tags-list">
// // // // // // // // //       {["Tech", "AI", "React", "Gaming", "Health", "News"].map(tag => (
// // // // // // // // //         <Link key={tag} to={`/tag/${tag}`} className="tag-link-sidebar">
// // // // // // // // //           #{tag}
// // // // // // // // //         </Link>
// // // // // // // // //       ))}
// // // // // // // // //     </div>
// // // // // // // // //   </div>

// // // // // // // // //   {/* Popular Posts */}
// // // // // // // // //   <div className="sidebar-widget popular-posts-widget">
// // // // // // // // //     <h4>Popular Posts</h4>
// // // // // // // // //     <ul>
// // // // // // // // //       {posts.slice(0, 5).map(p => (
// // // // // // // // //         <li key={p._id}>
// // // // // // // // //           <Link to={`/post/${p.slug}`}>{p.title}</Link>
// // // // // // // // //         </li>
// // // // // // // // //       ))}
// // // // // // // // //     </ul>
// // // // // // // // //   </div>

// // // // // // // // //   {/* Newsletter / Subscribe */}
// // // // // // // // //   <div className="sidebar-widget newsletter-widget">
// // // // // // // // //     <h4>Subscribe</h4>
// // // // // // // // //     <input type="email" placeholder="Your email..." />
// // // // // // // // //     <button>Subscribe</button>
// // // // // // // // //   </div>

// // // // // // // // //   {/* About / Author */}
// // // // // // // // //   <div className="sidebar-widget about-widget">
// // // // // // // // //     <h4>About Me</h4>
// // // // // // // // //     <img
// // // // // // // // //       src="/profile.jpg"
// // // // // // // // //       alt="Author"
// // // // // // // // //       className="about-avatar"
// // // // // // // // //     />
// // // // // // // // //     <p>
// // // // // // // // //       Hi! Iâ€™m Ayush, a tech enthusiast sharing latest news, tutorials, and insights. Follow me to stay updated!
// // // // // // // // //     </p>
// // // // // // // // //   </div>

// // // // // // // // //   {/* Social Media */}
// // // // // // // // //   <div className="sidebar-widget social-widget">
// // // // // // // // //     <h4>Follow Me</h4>
// // // // // // // // //     <div className="social-links">
// // // // // // // // //       <a href="https://twitter.com" target="_blank">ðŸ¦ Twitter</a>
// // // // // // // // //       <a href="https://linkedin.com" target="_blank">ðŸ’¼ LinkedIn</a>
// // // // // // // // //       <a href="https://github.com" target="_blank">ðŸ™ GitHub</a>
// // // // // // // // //     </div>
// // // // // // // // //   </div>

// // // // // // // // //   {/* Placeholder for future widgets */}
// // // // // // // // //   <div className="sidebar-widget future-widget">
// // // // // // // // //     <h4>More Widgets</h4>
// // // // // // // // //     <p>Add custom sections here anytime in future.</p>
// // // // // // // // //   </div>
// // // // // // // // //             {/* You can reuse your sidebar widgets here */}
// // // // // // // // //           </aside>
// // // // // // // // //         </main>

// // // // // // // // //         {showTop &&
// // // // // // // // //           <button className="back-to-top" onClick={() => window.scrollTo({ top: 0, behavior: "smooth" })}>â†‘</button>
// // // // // // // // //         }
// // // // // // // // //       </div>
// // // // // // // // //     </>
// // // // // // // // //   );
// // // // // // // // // };

// // // // // // // // // export default Home;



// // // // // // // // import React, { useEffect, useState, useRef, useCallback } from "react";
// // // // // // // // import Seo from "../components/Seo.jsx";
// // // // // // // // import PostList from "../components/PostList.jsx";
// // // // // // // // import { Loader, ErrorState } from "../components/Loader.jsx";
// // // // // // // // import TrendingPost from "../components/TrendingPost.jsx";
// // // // // // // // import "./Home.css";
// // // // // // // // import { Link } from "react-router-dom";

// // // // // // // // const POSTS_PER_PAGE = 10;
// // // // // // // // const CAROUSEL_DISPLAY = 4;

// // // // // // // // const Home = () => {
// // // // // // // //   const [posts, setPosts] = useState([]);
// // // // // // // //   const [page, setPage] = useState(1);
// // // // // // // //   const [hasMore, setHasMore] = useState(true);
// // // // // // // //   const [loadingPosts, setLoadingPosts] = useState(false);
// // // // // // // //   const [error, setError] = useState(null);
// // // // // // // //   const loadMoreRef = useRef(null);
// // // // // // // //   const scrollProgressRef = useRef(null);
// // // // // // // //   const [showTop, setShowTop] = useState(false);

// // // // // // // //   const [trendingPosts, setTrendingPosts] = useState([]);
// // // // // // // //   const [carouselIndex, setCarouselIndex] = useState(0);

// // // // // // // //   // Fetch main posts
// // // // // // // //   const fetchPosts = useCallback(() => {
// // // // // // // //     setLoadingPosts(true);
// // // // // // // //     setError(null);
// // // // // // // //     const url = new URL("http://localhost:4000/api/posts");
// // // // // // // //     url.searchParams.set("page", page);
// // // // // // // //     url.searchParams.set("limit", POSTS_PER_PAGE);

// // // // // // // //     fetch(url.toString())
// // // // // // // //       .then(res => { if (!res.ok) throw new Error("Failed to load posts"); return res.json(); })
// // // // // // // //       .then(data => {
// // // // // // // //         const newPosts = data.results || [];
// // // // // // // //         setPosts(prev => (page === 1 ? newPosts : [...prev, ...newPosts]));
// // // // // // // //         setHasMore(newPosts.length === POSTS_PER_PAGE);
// // // // // // // //         setLoadingPosts(false);
// // // // // // // //       })
// // // // // // // //       .catch(e => { setError(e.message); setLoadingPosts(false); });
// // // // // // // //   }, [page]);

// // // // // // // //   useEffect(() => { fetchPosts(); }, [fetchPosts]);

// // // // // // // //   // Infinite scroll
// // // // // // // //   useEffect(() => {
// // // // // // // //     if (!hasMore || loadingPosts) return;
// // // // // // // //     const observer = new IntersectionObserver(([entry]) => { if (entry.isIntersecting) setPage(p => p + 1); }, { rootMargin: "200px" });
// // // // // // // //     const current = loadMoreRef.current;
// // // // // // // //     if (current) observer.observe(current);
// // // // // // // //     return () => current && observer.unobserve(current);
// // // // // // // //   }, [hasMore, loadingPosts]);

// // // // // // // //   // Scroll progress bar
// // // // // // // //   useEffect(() => {
// // // // // // // //     const updateScrollProgress = () => {
// // // // // // // //       if (!scrollProgressRef.current) return;
// // // // // // // //       const scrollTop = window.scrollY;
// // // // // // // //       const docHeight = document.body.scrollHeight - window.innerHeight;
// // // // // // // //       const progress = Math.min((scrollTop / docHeight) * 100, 100);
// // // // // // // //       scrollProgressRef.current.style.width = `${progress}%`;
// // // // // // // //     };
// // // // // // // //     window.addEventListener("scroll", updateScrollProgress);
// // // // // // // //     return () => window.removeEventListener("scroll", updateScrollProgress);
// // // // // // // //   }, []);

// // // // // // // //   // Back to top button
// // // // // // // //   useEffect(() => {
// // // // // // // //     const onScroll = () => setShowTop(window.scrollY > 300);
// // // // // // // //     window.addEventListener("scroll", onScroll);
// // // // // // // //     return () => window.removeEventListener("scroll", onScroll);
// // // // // // // //   }, []);

// // // // // // // //   // Fetch trending posts
// // // // // // // //   useEffect(() => {
// // // // // // // //     fetch("http://localhost:4000/api/posts?trending=true&limit=10")
// // // // // // // //       .then(res => res.json())
// // // // // // // //       .then(data => setTrendingPosts(data.results || []))
// // // // // // // //       .catch(err => console.error("Trending posts fetch failed:", err));
// // // // // // // //   }, []);

// // // // // // // //   // Auto carousel slide
// // // // // // // //   useEffect(() => {
// // // // // // // //     const interval = setInterval(() => {
// // // // // // // //       setCarouselIndex(prev => (prev + 1) % trendingPosts.length);
// // // // // // // //     }, 5000); // 5 seconds
// // // // // // // //     return () => clearInterval(interval);
// // // // // // // //   }, [trendingPosts]);

// // // // // // // //   const handleNextCarousel = () => {
// // // // // // // //     setCarouselIndex(prev => (prev + 1) % trendingPosts.length);
// // // // // // // //   };
// // // // // // // //   const handlePrevCarousel = () => {
// // // // // // // //     setCarouselIndex(prev => (prev - 1 + trendingPosts.length) % trendingPosts.length);
// // // // // // // //   };

// // // // // // // //   const displayedCarousel = trendingPosts.slice(carouselIndex, carouselIndex + CAROUSEL_DISPLAY);

// // // // // // // //   return (
// // // // // // // //     <>
// // // // // // // //       <Seo title="Home" description="Explore top articles and latest news" />
// // // // // // // //       <div className="home-container">
// // // // // // // //         <div className="scroll-progress-bar" ref={scrollProgressRef}></div>

// // // // // // // //         {/* Featured Trending Slide Show */}
// // // // // // // //         {trendingPosts.length > 0 && (
// // // // // // // //           <section className="trending-carousel">
// // // // // // // //             <h3>ðŸ”¥ Trending Now</h3>
// // // // // // // //             <div className="carousel-wrapper">
// // // // // // // //               <button onClick={handlePrevCarousel} className="carousel-btn">â¬…</button>
// // // // // // // //               <div className="carousel-items">
// // // // // // // //                 {displayedCarousel.map(post => (
// // // // // // // //                   <TrendingPost key={post._id} big={false} post={post} />
// // // // // // // //                 ))}
// // // // // // // //               </div>
// // // // // // // //               <button onClick={handleNextCarousel} className="carousel-btn">âž¡</button>
// // // // // // // //             </div>
// // // // // // // //           </section>
// // // // // // // //         )}

// // // // // // // //         {/* Main Feed + Sidebar */}
// // // // // // // //         <main className="content-layout">
// // // // // // // //           <section className="main-feed">
// // // // // // // //             {error && <ErrorState msg={error} />}
// // // // // // // //             <PostList posts={posts} layout="grid-2col" />
// // // // // // // //             {!loadingPosts && hasMore && 
// // // // // // // //               <button className="load-more-btn" onClick={() => setPage(p => p + 1)}>Load More</button>
// // // // // // // //             }
// // // // // // // //             {loadingPosts && <Loader />}
// // // // // // // //             <div ref={loadMoreRef} style={{ height: 1 }} />
// // // // // // // //           </section>

// // // // // // // //           <aside className="sidebar">
// // // // // // // //             {/* Search */}
// // // // // // // //             <div className="sidebar-widget search-widget">
// // // // // // // //               <input type="text" placeholder="Search articles..." />
// // // // // // // //               <button>ðŸ”</button>
// // // // // // // //             </div>

// // // // // // // //             {/* Trending Tags */}
// // // // // // // //             <div className="sidebar-widget tags-widget">
// // // // // // // //               <h4>Trending Tags</h4>
// // // // // // // //               <div className="tags-list">
// // // // // // // //                 {["Tech", "AI", "React", "Gaming", "Health", "News"].map(tag => (
// // // // // // // //                   <Link key={tag} to={`/tag/${tag}`} className="tag-link-sidebar">#{tag}</Link>
// // // // // // // //                 ))}
// // // // // // // //               </div>
// // // // // // // //             </div>

// // // // // // // //             {/* Popular Posts */}
// // // // // // // //             <div className="sidebar-widget popular-posts-widget">
// // // // // // // //               <h4>Popular Posts</h4>
// // // // // // // //               <ul>
// // // // // // // //                 {posts.slice(0,5).map(p => (
// // // // // // // //                   <li key={p._id}><Link to={`/post/${p.slug}`}>{p.title}</Link></li>
// // // // // // // //                 ))}
// // // // // // // //               </ul>
// // // // // // // //             </div>

// // // // // // // //             {/* Newsletter */}
// // // // // // // //             <div className="sidebar-widget newsletter-widget">
// // // // // // // //               <h4>Subscribe</h4>
// // // // // // // //               <input type="email" placeholder="Your email..." />
// // // // // // // //               <button>Subscribe</button>
// // // // // // // //             </div>

// // // // // // // //             {/* About / Author */}
// // // // // // // //             <div className="sidebar-widget about-widget">
// // // // // // // //               <h4>About Me</h4>
// // // // // // // //               <img src="/profile.jpg" alt="Author" className="about-avatar" />
// // // // // // // //               <p>Hi! Iâ€™m Ayush, a tech enthusiast sharing latest news, tutorials, and insights. Follow me to stay updated!</p>
// // // // // // // //             </div>

// // // // // // // //             {/* Social Media */}
// // // // // // // //             <div className="sidebar-widget social-widget">
// // // // // // // //               <h4>Follow Me</h4>
// // // // // // // //               <div className="social-links">
// // // // // // // //                 <a href="https://twitter.com" target="_blank">ðŸ¦ Twitter</a>
// // // // // // // //                 <a href="https://linkedin.com" target="_blank">ðŸ’¼ LinkedIn</a>
// // // // // // // //                 <a href="https://github.com" target="_blank">ðŸ™ GitHub</a>
// // // // // // // //               </div>
// // // // // // // //             </div>

// // // // // // // //             {/* Future Widgets */}
// // // // // // // //             <div className="sidebar-widget future-widget">
// // // // // // // //               <h4>More Widgets</h4>
// // // // // // // //               <p>Add custom sections here anytime in future.</p>
// // // // // // // //             </div>
// // // // // // // //           </aside>
// // // // // // // //         </main>

// // // // // // // //         {showTop && <button className="back-to-top" onClick={() => window.scrollTo({ top: 0, behavior: "smooth" })}>â†‘</button>}
// // // // // // // //       </div>
// // // // // // // //     </>
// // // // // // // //   );
// // // // // // // // };

// // // // // // // // export default Home;



// // // // // // // import React, { useEffect, useState, useRef, useCallback } from "react";
// // // // // // // import Seo from "../components/Seo.jsx";
// // // // // // // import PostList from "../components/PostList.jsx";
// // // // // // // import { Loader, ErrorState } from "../components/Loader.jsx";
// // // // // // // import TrendingPost from "../components/TrendingPost.jsx";
// // // // // // // import "./Home.css";
// // // // // // // import { Link } from "react-router-dom";

// // // // // // // const POSTS_PER_PAGE = 10;
// // // // // // // const CAROUSEL_DISPLAY = 4;

// // // // // // // const Home = () => {
// // // // // // //   const [posts, setPosts] = useState([]);
// // // // // // //   const [page, setPage] = useState(1);
// // // // // // //   const [hasMore, setHasMore] = useState(true);
// // // // // // //   const [loadingPosts, setLoadingPosts] = useState(false);
// // // // // // //   const [error, setError] = useState(null);
// // // // // // //   const loadMoreRef = useRef(null);
// // // // // // //   const scrollProgressRef = useRef(null);
// // // // // // //   const [showTop, setShowTop] = useState(false);

// // // // // // //   const [trendingPosts, setTrendingPosts] = useState([]);
// // // // // // //   const [carouselIndex, setCarouselIndex] = useState(0);

// // // // // // //   // Fetch main posts
// // // // // // //   const fetchPosts = useCallback(() => {
// // // // // // //     setLoadingPosts(true);
// // // // // // //     setError(null);
// // // // // // //     const url = new URL("http://localhost:4000/api/posts");
// // // // // // //     url.searchParams.set("page", page);
// // // // // // //     url.searchParams.set("limit", POSTS_PER_PAGE);

// // // // // // //     fetch(url.toString())
// // // // // // //       .then(res => { if (!res.ok) throw new Error("Failed to load posts"); return res.json(); })
// // // // // // //       .then(data => {
// // // // // // //         const newPosts = data.results || [];
// // // // // // //         setPosts(prev => (page === 1 ? newPosts : [...prev, ...newPosts]));
// // // // // // //         setHasMore(newPosts.length === POSTS_PER_PAGE);
// // // // // // //         setLoadingPosts(false);
// // // // // // //       })
// // // // // // //       .catch(e => { setError(e.message); setLoadingPosts(false); });
// // // // // // //   }, [page]);

// // // // // // //   useEffect(() => { fetchPosts(); }, [fetchPosts]);

// // // // // // //   // Infinite scroll
// // // // // // //   useEffect(() => {
// // // // // // //     if (!hasMore || loadingPosts) return;
// // // // // // //     const observer = new IntersectionObserver(([entry]) => { if (entry.isIntersecting) setPage(p => p + 1); }, { rootMargin: "200px" });
// // // // // // //     const current = loadMoreRef.current;
// // // // // // //     if (current) observer.observe(current);
// // // // // // //     return () => current && observer.unobserve(current);
// // // // // // //   }, [hasMore, loadingPosts]);

// // // // // // //   // Scroll progress bar
// // // // // // //   useEffect(() => {
// // // // // // //     const updateScrollProgress = () => {
// // // // // // //       if (!scrollProgressRef.current) return;
// // // // // // //       const scrollTop = window.scrollY;
// // // // // // //       const docHeight = document.body.scrollHeight - window.innerHeight;
// // // // // // //       const progress = Math.min((scrollTop / docHeight) * 100, 100);
// // // // // // //       scrollProgressRef.current.style.width = `${progress}%`;
// // // // // // //     };
// // // // // // //     window.addEventListener("scroll", updateScrollProgress);
// // // // // // //     return () => window.removeEventListener("scroll", updateScrollProgress);
// // // // // // //   }, []);

// // // // // // //   // Back to top button
// // // // // // //   useEffect(() => {
// // // // // // //     const onScroll = () => setShowTop(window.scrollY > 300);
// // // // // // //     window.addEventListener("scroll", onScroll);
// // // // // // //     return () => window.removeEventListener("scroll", onScroll);
// // // // // // //   }, []);

// // // // // // //   // Fetch trending posts
// // // // // // //   useEffect(() => {
// // // // // // //     fetch("http://localhost:4000/api/posts?trending=true&limit=10")
// // // // // // //       .then(res => res.json())
// // // // // // //       .then(data => setTrendingPosts(data.results || []))
// // // // // // //       .catch(err => console.error("Trending posts fetch failed:", err));
// // // // // // //   }, []);

// // // // // // //   // âŒ Auto carousel slide removed

// // // // // // //   const handleNextCarousel = () => {
// // // // // // //     setCarouselIndex(prev => (prev + 1) % trendingPosts.length);
// // // // // // //   };
// // // // // // //   const handlePrevCarousel = () => {
// // // // // // //     setCarouselIndex(prev => (prev - 1 + trendingPosts.length) % trendingPosts.length);
// // // // // // //   };

// // // // // // //   const displayedCarousel = trendingPosts.slice(carouselIndex, carouselIndex + CAROUSEL_DISPLAY);

// // // // // // //   return (
// // // // // // //     <>
// // // // // // //       <Seo title="Home" description="Explore top articles and latest news" />
// // // // // // //       <div className="home-container">
// // // // // // //         <div className="scroll-progress-bar" ref={scrollProgressRef}></div>

// // // // // // //         {/* Featured Trending Section */}
// // // // // // //         {trendingPosts.length > 0 && (
// // // // // // //           <section className="trending-carousel">
// // // // // // //             <h3>ðŸ”¥ Trending Now</h3>
// // // // // // //             <div className="carousel-wrapper">
// // // // // // //               <button onClick={handlePrevCarousel} className="carousel-btn">â¬…</button>
// // // // // // //               <div className="carousel-items">
// // // // // // //                 {displayedCarousel.map(post => (
// // // // // // //                   <TrendingPost key={post._id} big={false} post={post} />
// // // // // // //                 ))}
// // // // // // //               </div>
// // // // // // //               <button onClick={handleNextCarousel} className="carousel-btn">âž¡</button>
// // // // // // //             </div>
// // // // // // //           </section>
// // // // // // //         )}

// // // // // // //         {/* Main Feed + Sidebar */}
// // // // // // //         <main className="content-layout">
// // // // // // //           <section className="main-feed">
// // // // // // //             {error && <ErrorState msg={error} />}
// // // // // // //             <PostList posts={posts} layout="grid-2col" />
// // // // // // //             {!loadingPosts && hasMore && 
// // // // // // //               <button className="load-more-btn" onClick={() => setPage(p => p + 1)}>Load More</button>
// // // // // // //             }
// // // // // // //             {loadingPosts && <Loader />}
// // // // // // //             <div ref={loadMoreRef} style={{ height: 1 }} />
// // // // // // //           </section>

// // // // // // //           <aside className="sidebar">
// // // // // // //             {/* Search */}
// // // // // // //             <div className="sidebar-widget search-widget">
// // // // // // //               <input type="text" placeholder="Search articles..." />
// // // // // // //               <button>ðŸ”</button>
// // // // // // //             </div>

// // // // // // //             {/* Trending Tags */}
// // // // // // //             <div className="sidebar-widget tags-widget">
// // // // // // //               <h4>Trending Tags</h4>
// // // // // // //               <div className="tags-list">
// // // // // // //                 {["Tech", "AI", "React", "Gaming", "Health", "News"].map(tag => (
// // // // // // //                   <Link key={tag} to={`/tag/${tag}`} className="tag-link-sidebar">#{tag}</Link>
// // // // // // //                 ))}
// // // // // // //               </div>
// // // // // // //             </div>

// // // // // // //             {/* Popular Posts */}
// // // // // // //             <div className="sidebar-widget popular-posts-widget">
// // // // // // //               <h4>Popular Posts</h4>
// // // // // // //               <ul>
// // // // // // //                 {posts.slice(0,5).map(p => (
// // // // // // //                   <li key={p._id}><Link to={`/post/${p.slug}`}>{p.title}</Link></li>
// // // // // // //                 ))}
// // // // // // //               </ul>
// // // // // // //             </div>

// // // // // // //             {/* Newsletter */}
// // // // // // //             <div className="sidebar-widget newsletter-widget">
// // // // // // //               <h4>Subscribe</h4>
// // // // // // //               <input type="email" placeholder="Your email..." />
// // // // // // //               <button>Subscribe</button>
// // // // // // //             </div>

// // // // // // //             {/* About / Author */}
// // // // // // //             <div className="sidebar-widget about-widget">
// // // // // // //               <h4>About Me</h4>
// // // // // // //               <img src="/profile.jpg" alt="Author" className="about-avatar" />
// // // // // // //               <p>Hi! Iâ€™m Ayush, a tech enthusiast sharing latest news, tutorials, and insights. Follow me to stay updated!</p>
// // // // // // //             </div>

// // // // // // //             {/* Social Media */}
// // // // // // //             <div className="sidebar-widget social-widget">
// // // // // // //               <h4>Follow Me</h4>
// // // // // // //               <div className="social-links">
// // // // // // //                 <a href="https://twitter.com" target="_blank">ðŸ¦ Twitter</a>
// // // // // // //                 <a href="https://linkedin.com" target="_blank">ðŸ’¼ LinkedIn</a>
// // // // // // //                 <a href="https://github.com" target="_blank">ðŸ™ GitHub</a>
// // // // // // //               </div>
// // // // // // //             </div>

// // // // // // //             {/* Future Widgets */}
// // // // // // //             <div className="sidebar-widget future-widget">
// // // // // // //               <h4>More Widgets</h4>
// // // // // // //               <p>Add custom sections here anytime in future.</p>
// // // // // // //             </div>
// // // // // // //           </aside>
// // // // // // //         </main>

// // // // // // //         {showTop && <button className="back-to-top" onClick={() => window.scrollTo({ top: 0, behavior: "smooth" })}>â†‘</button>}
// // // // // // //       </div>
// // // // // // //     </>
// // // // // // //   );
// // // // // // // };

// // // // // // // export default Home;


// // // // // // import React, { useEffect, useState, useRef, useCallback } from "react";
// // // // // // import Seo from "../components/Seo.jsx";
// // // // // // import PostList from "../components/PostList.jsx";
// // // // // // import { Loader, ErrorState } from "../components/Loader.jsx";
// // // // // // import "./Home.css";
// // // // // // import { Link } from "react-router-dom";

// // // // // // const POSTS_PER_PAGE = 10;

// // // // // // const Home = () => {
// // // // // //   const [posts, setPosts] = useState([]);
// // // // // //   const [page, setPage] = useState(1);
// // // // // //   const [hasMore, setHasMore] = useState(true);
// // // // // //   const [loadingPosts, setLoadingPosts] = useState(false);
// // // // // //   const [error, setError] = useState(null);
// // // // // //   const loadMoreRef = useRef(null);
// // // // // //   const scrollProgressRef = useRef(null);
// // // // // //   const [showTop, setShowTop] = useState(false);

// // // // // //   const [trendingPosts, setTrendingPosts] = useState([]);

// // // // // //   // Fetch main posts
// // // // // //   const fetchPosts = useCallback(() => {
// // // // // //     setLoadingPosts(true);
// // // // // //     setError(null);
// // // // // //     const url = new URL("http://localhost:4000/api/posts");
// // // // // //     url.searchParams.set("page", page);
// // // // // //     url.searchParams.set("limit", POSTS_PER_PAGE);

// // // // // //     fetch(url.toString())
// // // // // //       .then(res => { if (!res.ok) throw new Error("Failed to load posts"); return res.json(); })
// // // // // //       .then(data => {
// // // // // //         const newPosts = data.results || [];
// // // // // //         setPosts(prev => (page === 1 ? newPosts : [...prev, ...newPosts]));
// // // // // //         setHasMore(newPosts.length === POSTS_PER_PAGE);
// // // // // //         setLoadingPosts(false);
// // // // // //       })
// // // // // //       .catch(e => { setError(e.message); setLoadingPosts(false); });
// // // // // //   }, [page]);

// // // // // //   useEffect(() => { fetchPosts(); }, [fetchPosts]);

// // // // // //   // Infinite scroll
// // // // // //   useEffect(() => {
// // // // // //     if (!hasMore || loadingPosts) return;
// // // // // //     const observer = new IntersectionObserver(([entry]) => { if (entry.isIntersecting) setPage(p => p + 1); }, { rootMargin: "200px" });
// // // // // //     const current = loadMoreRef.current;
// // // // // //     if (current) observer.observe(current);
// // // // // //     return () => current && observer.unobserve(current);
// // // // // //   }, [hasMore, loadingPosts]);

// // // // // //   // Scroll progress bar
// // // // // //   useEffect(() => {
// // // // // //     const updateScrollProgress = () => {
// // // // // //       if (!scrollProgressRef.current) return;
// // // // // //       const scrollTop = window.scrollY;
// // // // // //       const docHeight = document.body.scrollHeight - window.innerHeight;
// // // // // //       const progress = Math.min((scrollTop / docHeight) * 100, 100);
// // // // // //       scrollProgressRef.current.style.width = `${progress}%`;
// // // // // //     };
// // // // // //     window.addEventListener("scroll", updateScrollProgress);
// // // // // //     return () => window.removeEventListener("scroll", updateScrollProgress);
// // // // // //   }, []);

// // // // // //   // Back to top button
// // // // // //   useEffect(() => {
// // // // // //     const onScroll = () => setShowTop(window.scrollY > 300);
// // // // // //     window.addEventListener("scroll", onScroll);
// // // // // //     return () => window.removeEventListener("scroll", onScroll);
// // // // // //   }, []);

// // // // // //   // Fetch trending posts
// // // // // //   useEffect(() => {
// // // // // //     fetch("http://localhost:4000/api/posts?trending=true&limit=10")
// // // // // //       .then(res => res.json())
// // // // // //       .then(data => setTrendingPosts(data.results || []))
// // // // // //       .catch(err => console.error("Trending posts fetch failed:", err));
// // // // // //   }, []);

// // // // // //   return (
// // // // // //     <>
// // // // // //       <Seo title="Home" description="Explore top articles and latest news" />
// // // // // //       <div className="home-container">
// // // // // //         <div className="scroll-progress-bar" ref={scrollProgressRef}></div>

// // // // // //         {/* Featured Trending Section */}
// // // // // //     {trendingPosts.length > 0 && (
// // // // // //   <section className="trending-section">
// // // // // //     <h3 className="section-title">ðŸ”¥ Trending Now</h3>
// // // // // //     <div className="trending-layout">
// // // // // //       {/* Featured Big Post */}
// // // // // //       <Link to={`/post/${trendingPosts[0].slug}`} className="trending-featured">
// // // // // //         <img src={trendingPosts[0].cover || "/placeholder.jpg"} alt={trendingPosts[0].title} />
// // // // // //         <div className="featured-content">
// // // // // //           <span className="category">{trendingPosts[0].category?.name || "Uncategorized"}</span>
// // // // // //           <h3>{trendingPosts[0].title}</h3>
// // // // // //         </div>
// // // // // //       </Link>

// // // // // //       {/* Side Mini Posts */}
// // // // // //       <div className="trending-side">
// // // // // //         {trendingPosts.slice(1,4).map(post => (
// // // // // //           <Link key={post._id} to={`/post/${post.slug}`} className="trending-mini">
// // // // // //             <img src={post.cover || "/placeholder.jpg"} alt={post.title} />
// // // // // //             <div className="mini-content">
// // // // // //               <span className="category">{post.category?.name || "Uncategorized"}</span>
// // // // // //               <h4>{post.title}</h4>
// // // // // //             </div>
// // // // // //           </Link>
// // // // // //         ))}
// // // // // //       </div>
// // // // // //     </div>
// // // // // //   </section>
// // // // // // )}



// // // // // //         {/* Main Feed + Sidebar */}
// // // // // //         <main className="content-layout">
// // // // // //           <section className="main-feed">
// // // // // //             {error && <ErrorState msg={error} />}
// // // // // //             <PostList posts={posts} layout="grid-2col" />
// // // // // //             {!loadingPosts && hasMore && 
// // // // // //               <button className="load-more-btn" onClick={() => setPage(p => p + 1)}>Load More</button>
// // // // // //             }
// // // // // //             {loadingPosts && <Loader />}
// // // // // //             <div ref={loadMoreRef} style={{ height: 1 }} />
// // // // // //           </section>

// // // // // //           <aside className="sidebar">
// // // // // //             {/* Search */}
// // // // // //             <div className="sidebar-widget search-widget">
// // // // // //               <input type="text" placeholder="Search articles..." />
// // // // // //               <button>ðŸ”</button>
// // // // // //             </div>

// // // // // //             {/* Trending Tags */}
// // // // // //             <div className="sidebar-widget tags-widget">
// // // // // //               <h4>Trending Tags</h4>
// // // // // //               <div className="tags-list">
// // // // // //                 {["Tech", "AI", "React", "Gaming", "Health", "News"].map(tag => (
// // // // // //                   <Link key={tag} to={`/tag/${tag}`} className="tag-link-sidebar">#{tag}</Link>
// // // // // //                 ))}
// // // // // //               </div>
// // // // // //             </div>

// // // // // //             {/* Popular Posts */}
// // // // // //             <div className="sidebar-widget popular-posts-widget">
// // // // // //               <h4>Popular Posts</h4>
// // // // // //               <ul>
// // // // // //                 {posts.slice(0,5).map(p => (
// // // // // //                   <li key={p._id}><Link to={`/post/${p.slug}`}>{p.title}</Link></li>
// // // // // //                 ))}
// // // // // //               </ul>
// // // // // //             </div>

// // // // // //             {/* Newsletter */}
// // // // // //             <div className="sidebar-widget newsletter-widget">
// // // // // //               <h4>Subscribe</h4>
// // // // // //               <input type="email" placeholder="Your email..." />
// // // // // //               <button>Subscribe</button>
// // // // // //             </div>

// // // // // //             {/* About / Author */}
// // // // // //             <div className="sidebar-widget about-widget">
// // // // // //               <h4>About Me</h4>
// // // // // //               <img src="/profile.jpg" alt="Author" className="about-avatar" />
// // // // // //               <p>Hi! Iâ€™m Ayush, a tech enthusiast sharing latest news, tutorials, and insights. Follow me to stay updated!</p>
// // // // // //             </div>

// // // // // //             {/* Social Media */}
// // // // // //             <div className="sidebar-widget social-widget">
// // // // // //               <h4>Follow Me</h4>
// // // // // //               <div className="social-links">
// // // // // //                 <a href="https://twitter.com" target="_blank">ðŸ¦ Twitter</a>
// // // // // //                 <a href="https://linkedin.com" target="_blank">ðŸ’¼ LinkedIn</a>
// // // // // //                 <a href="https://github.com" target="_blank">ðŸ™ GitHub</a>
// // // // // //               </div>
// // // // // //             </div>

// // // // // //             {/* Future Widgets */}
// // // // // //             <div className="sidebar-widget future-widget">
// // // // // //               <h4>More Widgets</h4>
// // // // // //               <p>Add custom sections here anytime in future.</p>
// // // // // //             </div>
// // // // // //           </aside>
// // // // // //         </main>

// // // // // //         {showTop && <button className="back-to-top" onClick={() => window.scrollTo({ top: 0, behavior: "smooth" })}>â†‘</button>}
// // // // // //       </div>
// // // // // //     </>
// // // // // //   );
// // // // // // };

// // // // // // export default Home;



// // // // import React, { useEffect, useState, useRef, useCallback } from "react";
// // // // import Seo from "../components/Seo.jsx";
// // // // import PostList from "../components/PostList.jsx";
// // // // import { Loader, ErrorState } from "../components/Loader.jsx";
// // // // import { Link } from "react-router-dom";
// // // // import "./Home.css";

// // // // const POSTS_PER_PAGE = 10;

// // // // const Home = () => {
// // // //   const [posts, setPosts] = useState([]);
// // // //   const [page, setPage] = useState(1);
// // // //   const [hasMore, setHasMore] = useState(true);
// // // //   const [loadingPosts, setLoadingPosts] = useState(false);
// // // //   const [error, setError] = useState(null);
// // // //   const loadMoreRef = useRef(null);
// // // //   const scrollProgressRef = useRef(null);
// // // //   const [showTop, setShowTop] = useState(false);

// // // //   const [trendingPosts, setTrendingPosts] = useState([]);

// // // //   // Fetch main posts
// // // //   const fetchPosts = useCallback(() => {
// // // //     setLoadingPosts(true);
// // // //     setError(null);
// // // //     const url = new URL("http://localhost:4000/api/posts");
// // // //     url.searchParams.set("page", page);
// // // //     url.searchParams.set("limit", POSTS_PER_PAGE);

// // // //     fetch(url.toString())
// // // //       .then(res => { if (!res.ok) throw new Error("Failed to load posts"); return res.json(); })
// // // //       .then(data => {
// // // //         const newPosts = data.results || [];
// // // //         setPosts(prev => (page === 1 ? newPosts : [...prev, ...newPosts]));
// // // //         setHasMore(newPosts.length === POSTS_PER_PAGE);
// // // //         setLoadingPosts(false);
// // // //       })
// // // //       .catch(e => { setError(e.message); setLoadingPosts(false); });
// // // //   }, [page]);

// // // //   useEffect(() => { fetchPosts(); }, [fetchPosts]);

// // // //   // Infinite scroll
// // // //   useEffect(() => {
// // // //     if (!hasMore || loadingPosts) return;
// // // //     const observer = new IntersectionObserver(([entry]) => { if (entry.isIntersecting) setPage(p => p + 1); }, { rootMargin: "200px" });
// // // //     const current = loadMoreRef.current;
// // // //     if (current) observer.observe(current);
// // // //     return () => current && observer.unobserve(current);
// // // //   }, [hasMore, loadingPosts]);

// // // //   // Scroll progress bar
// // // //   useEffect(() => {
// // // //     const updateScrollProgress = () => {
// // // //       if (!scrollProgressRef.current) return;
// // // //       const scrollTop = window.scrollY;
// // // //       const docHeight = document.body.scrollHeight - window.innerHeight;
// // // //       const progress = Math.min((scrollTop / docHeight) * 100, 100);
// // // //       scrollProgressRef.current.style.width = `${progress}%`;
// // // //     };
// // // //     window.addEventListener("scroll", updateScrollProgress);
// // // //     return () => window.removeEventListener("scroll", updateScrollProgress);
// // // //   }, []);

// // // //   // Back to top button
// // // //   useEffect(() => {
// // // //     const onScroll = () => setShowTop(window.scrollY > 300);
// // // //     window.addEventListener("scroll", onScroll);
// // // //     return () => window.removeEventListener("scroll", onScroll);
// // // //   }, []);

// // // //   // Fetch trending posts (admin-marked)
// // // //   useEffect(() => {
// // // //     fetch("http://localhost:4000/api/posts?limit=10")
// // // //       .then(res => res.json())
// // // //       .then(data => {
// // // //         const trending = (data.results || []).filter(post => post.isTrending);
// // // //         setTrendingPosts(trending);
// // // //       })
// // // //       .catch(err => console.error("Trending posts fetch failed:", err));
// // // //   }, []);

// // // //   return (
// // // //     <>
// // // //       <Seo title="Home" description="Explore top articles and latest news" />
// // // //       <div className="home-container">
// // // //         <div className="scroll-progress-bar" ref={scrollProgressRef}></div>

// // // //         {/* Featured Trending Section */}
// // // //         {trendingPosts.length > 0 && (
// // // //           <section className="trending-section">
// // // //             <h3 className="section-title">ðŸ”¥ Trending Now</h3>
// // // //             <div className="trending-layout">
// // // //               {/* Featured Big Post */}
// // // //               <Link to={`/post/${trendingPosts[0].slug}`} className="trending-featured">
// // // //                 <img src={trendingPosts[0].cover || "/placeholder.jpg"} alt={trendingPosts[0].title} />
// // // //                 <div className="featured-content">
// // // //                   <span className="category">{trendingPosts[0].category?.name || "Uncategorized"}</span>
// // // //                   <h3>{trendingPosts[0].title}</h3>
// // // //                 </div>
// // // //               </Link>

// // // //               {/* Side Mini Posts */}
// // // //               <div className="trending-side">
// // // //                 {trendingPosts.slice(1,4).map(post => (
// // // //                   <Link key={post._id} to={`/post/${post.slug}`} className="trending-mini">
// // // //                     <img src={post.cover || "/placeholder.jpg"} alt={post.title} />
// // // //                     <div className="mini-content">
// // // //                       <span className="category">{post.category?.name || "Uncategorized"}</span>
// // // //                       <h4>{post.title}</h4>
// // // //                     </div>
// // // //                   </Link>
// // // //                 ))}
// // // //               </div>
// // // //             </div>
// // // //           </section>
// // // //         )}

// // // //         {/* Main Feed + Sidebar */}
// // // //         <main className="content-layout">
// // // //           <section className="main-feed">
// // // //             {error && <ErrorState msg={error} />}
// // // //             <PostList posts={posts} layout="grid-2col" />
// // // //             {!loadingPosts && hasMore && 
// // // //               <button className="load-more-btn" onClick={() => setPage(p => p + 1)}>Load More</button>
// // // //             }
// // // //             {loadingPosts && <Loader />}
// // // //             <div ref={loadMoreRef} style={{ height: 1 }} />
// // // //           </section>

// // // //           <aside className="sidebar">
// // // //             {/* Search */}
// // // //             <div className="sidebar-widget search-widget">
// // // //               <input type="text" placeholder="Search articles..." />
// // // //               <button>ðŸ”</button>
// // // //             </div>

// // // //             {/* Trending Tags */}
// // // //             <div className="sidebar-widget tags-widget">
// // // //               <h4>Trending Tags</h4>
// // // //               <div className="tags-list">
// // // //                 {["Tech", "AI", "React", "Gaming", "Health", "News"].map(tag => (
// // // //                   <Link key={tag} to={`/tag/${tag}`} className="tag-link-sidebar">#{tag}</Link>
// // // //                 ))}
// // // //               </div>
// // // //             </div>

// // // //             {/* Popular Posts */}
// // // //             <div className="sidebar-widget popular-posts-widget">
// // // //               <h4>Popular Posts</h4>
// // // //               <ul>
// // // //                 {posts.slice(0,5).map(p => (
// // // //                   <li key={p._id}><Link to={`/post/${p.slug}`}>{p.title}</Link></li>
// // // //                 ))}
// // // //               </ul>
// // // //             </div>

// // // //             {/* Newsletter */}
// // // //             <div className="sidebar-widget newsletter-widget">
// // // //               <h4>Subscribe</h4>
// // // //               <input type="email" placeholder="Your email..." />
// // // //               <button>Subscribe</button>
// // // //             </div>

// // // //             {/* About / Author */}
// // // //             <div className="sidebar-widget about-widget">
// // // //               <h4>About Me</h4>
// // // //               <img src="/profile.jpg" alt="Author" className="about-avatar" />
// // // //               <p>Hi! Iâ€™m Ayush, a tech enthusiast sharing latest news, tutorials, and insights. Follow me to stay updated!</p>
// // // //             </div>

// // // //             {/* Social Media */}
// // // //             <div className="sidebar-widget social-widget">
// // // //               <h4>Follow Me</h4>
// // // //               <div className="social-links">
// // // //                 <a href="https://twitter.com" target="_blank">ðŸ¦ Twitter</a>
// // // //                 <a href="https://linkedin.com" target="_blank">ðŸ’¼ LinkedIn</a>
// // // //                 <a href="https://github.com" target="_blank">ðŸ™ GitHub</a>
// // // //               </div>
// // // //             </div>

// // // //             {/* Future Widgets */}
// // // //             <div className="sidebar-widget future-widget">
// // // //               <h4>More Widgets</h4>
// // // //               <p>Add custom sections here anytime in future.</p>
// // // //             </div>
// // // //           </aside>
// // // //         </main>

// // // //         {showTop && <button className="back-to-top" onClick={() => window.scrollTo({ top: 0, behavior: "smooth" })}>â†‘</button>}
// // // //       </div>
// // // //     </>
// // // //   );
// // // // };

// // // // export default Home;



// // // import React, { useEffect, useState, useRef, useCallback } from "react";
// // // import Seo from "../components/Seo.jsx";
// // // import PostList from "../components/PostList.jsx";
// // // import { Loader, ErrorState } from "../components/Loader.jsx";
// // // import { Link } from "react-router-dom";
// // // import "./Home.css";

// // // const POSTS_PER_PAGE = 10;

// // // const Home = () => {
// // //   const [posts, setPosts] = useState([]);
// // //   const [page, setPage] = useState(1);
// // //   const [hasMore, setHasMore] = useState(true);
// // //   const [loadingPosts, setLoadingPosts] = useState(false);
// // //   const [error, setError] = useState(null);
// // //   const loadMoreRef = useRef(null);
// // //   const scrollProgressRef = useRef(null);
// // //   const [showTop, setShowTop] = useState(false);

// // //   const [trendingPosts, setTrendingPosts] = useState([]);

// // //   // Fetch main posts
// // //   const fetchPosts = useCallback(() => {
// // //     setLoadingPosts(true);
// // //     setError(null);
// // //     const url = new URL("http://localhost:4000/api/posts");
// // //     url.searchParams.set("page", page);
// // //     url.searchParams.set("limit", POSTS_PER_PAGE);

// // //     fetch(url.toString())
// // //       .then(res => { if (!res.ok) throw new Error("Failed to load posts"); return res.json(); })
// // //       .then(data => {
// // //         const newPosts = data.results || [];
// // //         setPosts(prev => (page === 1 ? newPosts : [...prev, ...newPosts]));
// // //         setHasMore(newPosts.length === POSTS_PER_PAGE);
// // //         setLoadingPosts(false);
// // //       })
// // //       .catch(e => { setError(e.message); setLoadingPosts(false); });
// // //   }, [page]);

// // //   useEffect(() => { fetchPosts(); }, [fetchPosts]);

// // //   // Infinite scroll
// // //   useEffect(() => {
// // //     if (!hasMore || loadingPosts) return;
// // //     const observer = new IntersectionObserver(
// // //       ([entry]) => { if (entry.isIntersecting) setPage(p => p + 1); }, 
// // //       { rootMargin: "200px" }
// // //     );
// // //     const current = loadMoreRef.current;
// // //     if (current) observer.observe(current);
// // //     return () => current && observer.unobserve(current);
// // //   }, [hasMore, loadingPosts]);

// // //   // Scroll progress bar
// // //   useEffect(() => {
// // //     const updateScrollProgress = () => {
// // //       if (!scrollProgressRef.current) return;
// // //       const scrollTop = window.scrollY;
// // //       const docHeight = document.body.scrollHeight - window.innerHeight;
// // //       const progress = Math.min((scrollTop / docHeight) * 100, 100);
// // //       scrollProgressRef.current.style.width = `${progress}%`;
// // //     };
// // //     window.addEventListener("scroll", updateScrollProgress);
// // //     return () => window.removeEventListener("scroll", updateScrollProgress);
// // //   }, []);

// // //   // Back to top button
// // //   useEffect(() => {
// // //     const onScroll = () => setShowTop(window.scrollY > 300);
// // //     window.addEventListener("scroll", onScroll);
// // //     return () => window.removeEventListener("scroll", onScroll);
// // //   }, []);

// // //   // Fetch trending posts (admin-marked)
// // //   useEffect(() => {
// // //     fetch("http://localhost:4000/api/posts?limit=10")
// // //       .then(res => res.json())
// // //       .then(data => {
// // //         const trending = (data.results || []).filter(post => post.isTrending);
// // //         setTrendingPosts(trending);
// // //       })
// // //       .catch(err => console.error("Trending posts fetch failed:", err));
// // //   }, []);

// // //   return (
// // //     <>
// // //       <Seo title="Home" description="Explore top articles and latest news" />
// // //       <div className="home-container">
// // //         <div className="scroll-progress-bar" ref={scrollProgressRef}></div>

// // //         {/* Featured Trending Section */}
// // //         {trendingPosts.length > 0 && (
// // //           <section className="trending-section">
// // //             <h3 className="section-title">ðŸ”¥ Trending Now</h3>
// // //             <div className="trending-layout">
// // //               {/* Featured Big Post */}
// // //               <Link to={`/post/${trendingPosts[0].slug}`} className="trending-featured">
// // //                 <img src={trendingPosts[0].cover || "/placeholder.jpg"} alt={trendingPosts[0].title} />
// // //                 <div className="featured-content">
// // //                   <span className="category">{trendingPosts[0].category?.name || "Uncategorized"}</span>
// // //                   <h3>{trendingPosts[0].title}</h3>
// // //                 </div>
// // //               </Link>

// // //               {/* Side Posts (Bigger + Clear) */}
// // //               <div className="trending-side">
// // //                 {trendingPosts.slice(1,4).map(post => (
// // //                   <Link key={post._id} to={`/post/${post.slug}`} className="trending-side-post">
// // //                     <img src={post.cover || "/placeholder.jpg"} alt={post.title} />
// // //                     <div className="side-content">
// // //                       <span className="category">{post.category?.name || "Uncategorized"}</span>
// // //                       <h3>{post.title}</h3>
// // //                     </div>
// // //                   </Link>
// // //                 ))}
// // //               </div>
// // //             </div>
// // //           </section>
// // //         )}

// // //         {/* Main Feed + Sidebar */}
// // //         <main className="content-layout">
// // //           <section className="main-feed">
// // //             {error && <ErrorState msg={error} />}
// // //             <PostList posts={posts} layout="grid-2col" />
// // //             {!loadingPosts && hasMore && 
// // //               <button className="load-more-btn" onClick={() => setPage(p => p + 1)}>Load More</button>
// // //             }
// // //             {loadingPosts && <Loader />}
// // //             <div ref={loadMoreRef} style={{ height: 1 }} />
// // //           </section>

// // //           <aside className="sidebar">
// // //             {/* Sidebar Widgets */}
// // //             <div className="sidebar-widget search-widget">
// // //               <input type="text" placeholder="Search articles..." />
// // //               <button>ðŸ”</button>
// // //             </div>

// // //             <div className="sidebar-widget tags-widget">
// // //               <h4>Trending Tags</h4>
// // //               <div className="tags-list">
// // //                 {["Tech", "AI", "React", "Gaming", "Health", "News"].map(tag => (
// // //                   <Link key={tag} to={`/tag/${tag}`} className="tag-link-sidebar">#{tag}</Link>
// // //                 ))}
// // //               </div>
// // //             </div>

// // //             <div className="sidebar-widget popular-posts-widget">
// // //               <h4>Popular Posts</h4>
// // //               <ul>
// // //                 {posts.slice(0,5).map(p => (
// // //                   <li key={p._id}><Link to={`/post/${p.slug}`}>{p.title}</Link></li>
// // //                 ))}
// // //               </ul>
// // //             </div>

// // //             <div className="sidebar-widget newsletter-widget">
// // //               <h4>Subscribe</h4>
// // //               <input type="email" placeholder="Your email..." />
// // //               <button>Subscribe</button>
// // //             </div>

// // //             <div className="sidebar-widget about-widget">
// // //               <h4>About Me</h4>
// // //               <img src="/profile.jpg" alt="Author" className="about-avatar" />
// // //               <p>Hi! Iâ€™m Ayush, a tech enthusiast sharing latest news, tutorials, and insights. Follow me to stay updated!</p>
// // //             </div>

// // //             <div className="sidebar-widget social-widget">
// // //               <h4>Follow Me</h4>
// // //               <div className="social-links">
// // //                 <a href="https://twitter.com" target="_blank">ðŸ¦ Twitter</a>
// // //                 <a href="https://linkedin.com" target="_blank">ðŸ’¼ LinkedIn</a>
// // //                 <a href="https://github.com" target="_blank">ðŸ™ GitHub</a>
// // //               </div>
// // //             </div>

// // //             <div className="sidebar-widget future-widget">
// // //               <h4>More Widgets</h4>
// // //               <p>Add custom sections here anytime in future.</p>
// // //             </div>
// // //           </aside>
// // //         </main>

// // //         {showTop && <button className="back-to-top" onClick={() => window.scrollTo({ top: 0, behavior: "smooth" })}>â†‘</button>}
// // //       </div>
// // //     </>
// // //   );
// // // };

// // // export default Home;



// // import React, { useEffect, useState, useRef, useCallback } from "react";
// // import Seo from "../components/Seo.jsx";
// // import PostList from "../components/PostList.jsx";
// // import { Loader, ErrorState } from "../components/Loader.jsx";
// // import { Link } from "react-router-dom";
// // import "./Home.css";

// // const POSTS_PER_PAGE = 10;

// // const Home = () => {
// //   const [posts, setPosts] = useState([]);
// //   const [page, setPage] = useState(1);
// //   const [hasMore, setHasMore] = useState(true);
// //   const [loadingPosts, setLoadingPosts] = useState(false);
// //   const [error, setError] = useState(null);
// //   const loadMoreRef = useRef(null);
// //   const scrollProgressRef = useRef(null);
// //   const [showTop, setShowTop] = useState(false);

// //   const [trendingPosts, setTrendingPosts] = useState([]);
// //   const [newPosts, setNewPosts] = useState([]); // for side empty space

// //   // Fetch main posts
// //   const fetchPosts = useCallback(() => {
// //     setLoadingPosts(true);
// //     setError(null);
// //     const url = new URL("http://localhost:4000/api/posts");
// //     url.searchParams.set("page", page);
// //     url.searchParams.set("limit", POSTS_PER_PAGE);

// //     fetch(url.toString())
// //       .then(res => { if (!res.ok) throw new Error("Failed to load posts"); return res.json(); })
// //       .then(data => {
// //         const newPostsData = data.results || [];
// //         setPosts(prev => (page === 1 ? newPostsData : [...prev, ...newPostsData]));
// //         setHasMore(newPostsData.length === POSTS_PER_PAGE);
// //         setLoadingPosts(false);
// //       })
// //       .catch(e => { setError(e.message); setLoadingPosts(false); });
// //   }, [page]);

// //   useEffect(() => { fetchPosts(); }, [fetchPosts]);

// //   // Infinite scroll
// //   useEffect(() => {
// //     if (!hasMore || loadingPosts) return;
// //     const observer = new IntersectionObserver(
// //       ([entry]) => { if (entry.isIntersecting) setPage(p => p + 1); }, 
// //       { rootMargin: "200px" }
// //     );
// //     const current = loadMoreRef.current;
// //     if (current) observer.observe(current);
// //     return () => current && observer.unobserve(current);
// //   }, [hasMore, loadingPosts]);

// //   // Scroll progress bar
// //   useEffect(() => {
// //     const updateScrollProgress = () => {
// //       if (!scrollProgressRef.current) return;
// //       const scrollTop = window.scrollY;
// //       const docHeight = document.body.scrollHeight - window.innerHeight;
// //       const progress = Math.min((scrollTop / docHeight) * 100, 100);
// //       scrollProgressRef.current.style.width = `${progress}%`;
// //     };
// //     window.addEventListener("scroll", updateScrollProgress);
// //     return () => window.removeEventListener("scroll", updateScrollProgress);
// //   }, []);

// //   // Back to top button
// //   useEffect(() => {
// //     const onScroll = () => setShowTop(window.scrollY > 300);
// //     window.addEventListener("scroll", onScroll);
// //     return () => window.removeEventListener("scroll", onScroll);
// //   }, []);

// //   // Fetch trending posts and new posts for side
// //   useEffect(() => {
// //     fetch("http://localhost:4000/api/posts?limit=10")
// //       .then(res => res.json())
// //       .then(data => {
// //         const allPosts = data.results || [];
// //         const trending = allPosts.filter(post => post.isTrending);
// //         const newSidePosts = allPosts
// //           .filter(post => !post.isTrending)
// //           .slice(0, 2); // top 3 new posts for side
// //         setTrendingPosts(trending);
// //         setNewPosts(newSidePosts);
// //       })
// //       .catch(err => console.error("Trending posts fetch failed:", err));
// //   }, []);

// //   return (
// //     <>
// //       <Seo title="Home" description="Explore top articles and latest news" />
// //       <div className="home-container">
// //         <div className="scroll-progress-bar" ref={scrollProgressRef}></div>

// //         {/* Featured Trending Section */}
// //         {trendingPosts.length > 0 && (
// //           <section className="trending-section">
// //             <h3 className="section-title">ðŸ”¥ Trending Now</h3>
// //             <div className="trending-layout">
// //               {/* Featured Big Post */}
// //               <Link to={`/post/${trendingPosts[0].slug}`} className="trending-featured">
// //                 <img src={trendingPosts[0].cover || "/placeholder.jpg"} alt={trendingPosts[0].title} />
// //                 <div className="featured-content">
// //                   <span className="category">{trendingPosts[0].category?.name || "Uncategorized"}</span>
// //                   <h3>{trendingPosts[0].title}</h3>
// //                 </div>
// //               </Link>

// //               {/* Side Posts (Trending + New) */}
// //              {/* Side Posts (Trending + New) */}
// // <div className="trending-side">
// //   {trendingPosts.slice(1,3).map(post => (
// //     <Link key={post._id} to={`/post/${post.slug}`} className="trending-side-post">
// //       <img src={post.cover || "/placeholder.jpg"} alt={post.title} />
// //       <div className="side-content">
// //         <span className="category">{post.category?.name || "Uncategorized"}</span>
// //         <h3>{post.title}</h3>
// //       </div>
// //     </Link>
// //   ))}
// //   {newPosts.map(post => (
// //     <Link key={post._id} to={`/post/${post.slug}`} className="trending-side-post">
// //       <img src={post.cover || "/placeholder.jpg"} alt={post.title} />
// //       <div className="side-content">
// //         <span className="category">{post.category?.name || "Uncategorized"}</span>
// //         <h3>{post.title}</h3>
// //       </div>
// //     </Link>
// //   ))}
// // </div>

// //             </div>
// //           </section>
// //         )}

// //         {/* Main Feed + Sidebar */}
// //         <main className="content-layout">
// //           <section className="main-feed">
// //             {error && <ErrorState msg={error} />}
// //             <PostList posts={posts} layout="grid-2col" />
// //             {!loadingPosts && hasMore && 
// //               <button className="load-more-btn" onClick={() => setPage(p => p + 1)}>Load More</button>
// //             }
// //             {loadingPosts && <Loader />}
// //             <div ref={loadMoreRef} style={{ height: 1 }} />
// //           </section>

// //           <aside className="sidebar">
// //             <div className="sidebar-widget search-widget">
// //               <input type="text" placeholder="Search articles..." />
// //               <button>ðŸ”</button>
// //             </div>

// //             <div className="sidebar-widget tags-widget">
// //               <h4>Trending Tags</h4>
// //               <div className="tags-list">
// //                 {["Tech", "AI", "React", "Gaming", "Health", "News"].map(tag => (
// //                   <Link key={tag} to={`/tag/${tag}`} className="tag-link-sidebar">#{tag}</Link>
// //                 ))}
// //               </div>
// //             </div>

// //             <div className="sidebar-widget popular-posts-widget">
// //               <h4>Popular Posts</h4>
// //               <ul>
// //                 {posts.slice(0,5).map(p => (
// //                   <li key={p._id}><Link to={`/post/${p.slug}`}>{p.title}</Link></li>
// //                 ))}
// //               </ul>
// //             </div>

// //             <div className="sidebar-widget newsletter-widget">
// //               <h4>Subscribe</h4>
// //               <input type="email" placeholder="Your email..." />
// //               <button>Subscribe</button>
// //             </div>

// //             <div className="sidebar-widget about-widget">
// //               <h4>About Me</h4>
// //               <img src="/profile.jpg" alt="Author" className="about-avatar" />
// //               <p>Hi! Iâ€™m Ayush, a tech enthusiast sharing latest news, tutorials, and insights. Follow me to stay updated!</p>
// //             </div>

// //             <div className="sidebar-widget social-widget">
// //               <h4>Follow Me</h4>
// //               <div className="social-links">
// //                 <a href="https://twitter.com" target="_blank">ðŸ¦ Twitter</a>
// //                 <a href="https://linkedin.com" target="_blank">ðŸ’¼ LinkedIn</a>
// //                 <a href="https://github.com" target="_blank">ðŸ™ GitHub</a>
// //               </div>
// //             </div>

// //             <div className="sidebar-widget future-widget">
// //               <h4>More Widgets</h4>
// //               <p>Add custom sections here anytime in future.</p>
// //             </div>
// //           </aside>
// //         </main>

// //         {showTop && <button className="back-to-top" onClick={() => window.scrollTo({ top: 0, behavior: "smooth" })}>â†‘</button>}
// //       </div>
// //     </>
// //   );
// // };

// // export default Home;



// import React, { useEffect, useState, useRef, useCallback } from "react";
// import Seo from "../components/Seo.jsx";
// import PostList from "../components/PostList.jsx";
// import { Loader, ErrorState } from "../components/Loader.jsx";
// import { Link } from "react-router-dom";
// import "./Home.css";

// const POSTS_PER_PAGE = 9;

// const Home = () => {
//   const [posts, setPosts] = useState([]);
//   const [page, setPage] = useState(1);
//   const [hasMore, setHasMore] = useState(true);
//   const [loadingPosts, setLoadingPosts] = useState(false);
//   const [error, setError] = useState(null);
//   const loadMoreRef = useRef(null);
//   const scrollProgressRef = useRef(null);
//   const [showTop, setShowTop] = useState(false);
//   const [trendingPosts, setTrendingPosts] = useState([]);

//   const [newPosts, setNewPosts] = useState([]); // top trending side posts ke liye

//   const fetchPosts = useCallback(() => {
//     setLoadingPosts(true);
//     setError(null);
//     const url = new URL("http://localhost:4000/api/posts");
//     url.searchParams.set("page", page);
//     url.searchParams.set("limit", POSTS_PER_PAGE);

//     fetch(url.toString())
//       .then(res => { if (!res.ok) throw new Error("Failed to load posts"); return res.json(); })
//       .then(data => {
//         const newPostsData = data.results || [];
//         setPosts(prev => (page === 1 ? newPostsData : [...prev, ...newPostsData]));
//         setHasMore(newPostsData.length === POSTS_PER_PAGE);
//         setLoadingPosts(false);
//       })
//       .catch(e => { setError(e.message); setLoadingPosts(false); });
//   }, [page]);

//   useEffect(() => { fetchPosts(); }, [fetchPosts]);

//   useEffect(() => {
//     if (!hasMore || loadingPosts) return;
//     const observer = new IntersectionObserver(
//       ([entry]) => { if (entry.isIntersecting) setPage(p => p + 1); }, 
//       { rootMargin: "200px" }
//     );
//     const current = loadMoreRef.current;
//     if (current) observer.observe(current);
//     return () => current && observer.unobserve(current);
//   }, [hasMore, loadingPosts]);

//   useEffect(() => {
//     const updateScrollProgress = () => {
//       if (!scrollProgressRef.current) return;
//       const scrollTop = window.scrollY;
//       const docHeight = document.body.scrollHeight - window.innerHeight;
//       const progress = Math.min((scrollTop / docHeight) * 100, 100);
//       scrollProgressRef.current.style.width = `${progress}%`;
//     };
//     window.addEventListener("scroll", updateScrollProgress);
//     return () => window.removeEventListener("scroll", updateScrollProgress);
//   }, []);

//   useEffect(() => {
//     const onScroll = () => setShowTop(window.scrollY > 300);
//     window.addEventListener("scroll", onScroll);
//     return () => window.removeEventListener("scroll", onScroll);
//   }, []);

//   useEffect(() => {
//     fetch("http://localhost:4000/api/posts?limit=5")
//       .then(res => res.json())
//       .then(data => {
//         const trending = (data.results || []).filter(p => p.isTrending);
//         setTrendingPosts(trending);
//       })
//       .catch(err => console.error(err));
//   }, []);

//   return (
//     <>
//       <Seo title="Home" description="Explore top articles and latest news" />
//       <div className="home-container">
//         <div className="scroll-progress-bar" ref={scrollProgressRef}></div>

//         {/* Trending Section */}
//        {/* Trending Section */}
// {trendingPosts.length > 0 && (
//   <section className="trending-section">
//     <h3 className="section-title">ðŸ”¥ Trending Now</h3>
//     <div className="trending-layout">
//       {/* Main Featured Trending Post */}
//       <div className="trending-featured-wrap">
//         <Link to={`/post/${trendingPosts[0].slug}`} className="trending-featured">
//           <img src={trendingPosts[0].cover || "/placeholder.jpg"} alt={trendingPosts[0].title} />
//           <div className="featured-content">
//             <span className="category">{trendingPosts[0].category?.name || "Uncategorized"}</span>
//             <h3>{trendingPosts[0].title}</h3>
//           </div>
//         </Link>
//       </div>

//       {/* Side Posts (Trending + New) */}
//       <div className="trending-side-row">
//         {/* Remaining Trending Posts */}
//         {trendingPosts.slice(1, 3).map(post => (
//           <Link key={post._id} to={`/post/${post.slug}`} className="trending-side-post">
//             <img src={post.cover || "/placeholder.jpg"} alt={post.title} />
//             <div className="side-content">
//               <span className="category">{post.category?.name || "Uncategorized"}</span>
//               <h4>{post.title}</h4>
//             </div>
//           </Link>
//         ))}

//         {/* Additional New Posts (top 2) */}
//         {newPosts.slice(0, 2).map(post => (
//           <Link key={post._id} to={`/post/${post.slug}`} className="trending-side-post">
//             <img src={post.cover || "/placeholder.jpg"} alt={post.title} />
//             <div className="side-content">
//               <span className="category">{post.category?.name || "Uncategorized"}</span>
//               <h4>{post.title}</h4>
//             </div>
//           </Link>
//         ))}
//       </div>
//     </div>
//   </section>
// )}


//         {/* Main Feed Grid 3-columns */}
//         <section className="main-feed-grid">
//           {error && <ErrorState msg={error} />}
//           <div className="grid-3">
//             {posts.map(post => (
//               <PostList key={post._id} posts={[post]} layout="card" />
//             ))}
//           </div>
//           {loadingPosts && <Loader />}
//           {!loadingPosts && hasMore && 
//             <button className="load-more-btn" onClick={() => setPage(p => p + 1)}>Load More</button>
//           }
//           <div ref={loadMoreRef} style={{ height: 1 }} />
//         </section>

//         {showTop && <button className="back-to-top" onClick={() => window.scrollTo({ top: 0, behavior: "smooth" })}>â†‘</button>}
//       </div>
//     </>
//   );
// };

// export default Home;



import React, { useEffect, useState, useRef, useCallback } from "react";
import Seo from "../components/Seo.jsx";
import PostList from "../components/PostList.jsx";
import { Loader, ErrorState } from "../components/Loader.jsx";
import { Link } from "react-router-dom";
import "./Home.css";

const POSTS_PER_PAGE = 9;

const Home = () => {
  const [posts, setPosts] = useState([]);
  const [page, setPage] = useState(1);
  const [hasMore, setHasMore] = useState(true);
  const [loadingPosts, setLoadingPosts] = useState(false);
  const [error, setError] = useState(null);
  const loadMoreRef = useRef(null);
  const scrollProgressRef = useRef(null);
  const [showTop, setShowTop] = useState(false);

  const [trendingPosts, setTrendingPosts] = useState([]);
  const [newPosts, setNewPosts] = useState([]); // side ke liye

  /** Fetch paginated posts */
  const fetchPosts = useCallback(() => {
    setLoadingPosts(true);
    setError(null);
    const url = new URL("http://localhost:4000/api/posts");
    url.searchParams.set("page", page);
    url.searchParams.set("limit", POSTS_PER_PAGE);

    fetch(url.toString())
      .then(res => {
        if (!res.ok) throw new Error("Failed to load posts");
        return res.json();
      })
      .then(data => {
        const newPostsData = data.results || [];
        setPosts(prev => (page === 1 ? newPostsData : [...prev, ...newPostsData]));
        setHasMore(newPostsData.length === POSTS_PER_PAGE);
        setLoadingPosts(false);
      })
      .catch(e => {
        setError(e.message);
        setLoadingPosts(false);
      });
  }, [page]);

  useEffect(() => { fetchPosts(); }, [fetchPosts]);

  /** Infinite scroll observer */
  useEffect(() => {
    if (!hasMore || loadingPosts) return;
    const observer = new IntersectionObserver(
      ([entry]) => { if (entry.isIntersecting) setPage(p => p + 1); },
      { rootMargin: "200px" }
    );
    const current = loadMoreRef.current;
    if (current) observer.observe(current);
    return () => current && observer.unobserve(current);
  }, [hasMore, loadingPosts]);

  /** Scroll progress bar */
  useEffect(() => {
    const updateScrollProgress = () => {
      if (!scrollProgressRef.current) return;
      const scrollTop = window.scrollY;
      const docHeight = document.body.scrollHeight - window.innerHeight;
      const progress = Math.min((scrollTop / docHeight) * 100, 100);
      scrollProgressRef.current.style.width = `${progress}%`;
    };
    window.addEventListener("scroll", updateScrollProgress);
    return () => window.removeEventListener("scroll", updateScrollProgress);
  }, []);

  /** Back to top button */
  useEffect(() => {
    const onScroll = () => setShowTop(window.scrollY > 300);
    window.addEventListener("scroll", onScroll);
    return () => window.removeEventListener("scroll", onScroll);
  }, []);

  /** Fetch trending + new posts */
  useEffect(() => {
    fetch("http://localhost:4000/api/posts?limit=7")
      .then(res => res.json())
      .then(data => {
        const all = data.results || [];
        const trending = all.filter(p => p.isTrending).slice(0, 1); // sirf 1 trending
        const latest = all.filter(p => !p.isTrending).slice(0, 2); // side ke liye 2 new
        setTrendingPosts(trending);
        setNewPosts(latest);
      })
      .catch(err => console.error(err));
  }, []);

  return (
    <>
      <Seo title="Home" description="Explore top articles and latest news" />
      <div className="home-container">
        <div className="scroll-progress-bar" ref={scrollProgressRef}></div>

        {/* Trending Section */}
        {trendingPosts.length > 0 && (
          <section className="trending-section">
            <h3 className="section-title">ðŸ”¥ Trending Now</h3>
            <div className="trending-layout">
              {/* Main Featured Trending Post */}
              <div className="trending-featured-wrap big">
                <Link to={`/post/${trendingPosts[0].slug}`} className="trending-featured">
                  <img src={trendingPosts[0].cover || "/placeholder.jpg"} alt={trendingPosts[0].title} />
                  <div className="featured-content">
                    <span className="category">{trendingPosts[0].category?.name || "Uncategorized"}</span>
                    <h3>{trendingPosts[0].title}</h3>
                  </div>
                </Link>
              </div>

              {/* Side New Posts */}
              <div className="trending-side-row">
                {newPosts.map(post => (
                  <Link key={post._id} to={`/post/${post.slug}`} className="trending-side-post">
                    <img src={post.cover || "/placeholder.jpg"} alt={post.title} />
                    <div className="side-content">
                      <span className="category">{post.category?.name || "Uncategorized"}</span>
                      <h4>{post.title}</h4>
                    </div>
                  </Link>
                ))}
              </div>
            </div>
          </section>
        )}

        {/* Main Feed Grid */}
        <section className="main-feed-grid">
          {error && <ErrorState msg={error} />}
          <div className="grid-3">
            {posts.map(post => (
              <PostList key={post._id} posts={[post]} layout="card" />
            ))}
          </div>
          {loadingPosts && <Loader />}
          {!loadingPosts && hasMore &&
            <button className="load-more-btn" onClick={() => setPage(p => p + 1)}>Load More</button>
          }
          <div ref={loadMoreRef} style={{ height: 1 }} />
        </section>

        {showTop && (
          <button
            className="back-to-top"
            onClick={() => window.scrollTo({ top: 0, behavior: "smooth" })}
          >
            â†‘
          </button>
        )}
      </div>
    </>
  );
};

export default Home;
